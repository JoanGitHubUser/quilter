/* WebView.c generated by valac 0.50.2, the Vala compiler
 * generated from WebView.vala, do not modify */

/*
* Copyright (c) 2017-2021 Lains
*
* This program is free software; you can redistribute it and/or
* modify it under the terms of the GNU General Public
* License as published by the Free Software Foundation; either
* version 2 of the License, or (at your option) any later version.
*
* This program is distributed in the hope that it will be useful,
* but WITHOUT ANY WARRANTY; without even the implied warranty of
* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
* General Public License for more details.
*
* You should have received a copy of the GNU General Public
* License along with this program; if not, write to the
* Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor,
* Boston, MA 02110-1301 USA
*
*/

#include <webkit2/webkit2.h>
#include <glib-object.h>
#include <gtksourceview/gtksource.h>
#include <stdlib.h>
#include <string.h>
#include <glib.h>
#include <gdk/gdk.h>
#include <handy.h>
#include <gtk/gtk.h>
#include <float.h>
#include <math.h>
#include <gio/gio.h>
#include <cairo-gobject.h>
#include "mkdio.h"

#define QUILTER_WIDGETS_TYPE_PREVIEW (quilter_widgets_preview_get_type ())
#define QUILTER_WIDGETS_PREVIEW(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), QUILTER_WIDGETS_TYPE_PREVIEW, QuilterWidgetsPreview))
#define QUILTER_WIDGETS_PREVIEW_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), QUILTER_WIDGETS_TYPE_PREVIEW, QuilterWidgetsPreviewClass))
#define QUILTER_WIDGETS_IS_PREVIEW(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), QUILTER_WIDGETS_TYPE_PREVIEW))
#define QUILTER_WIDGETS_IS_PREVIEW_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), QUILTER_WIDGETS_TYPE_PREVIEW))
#define QUILTER_WIDGETS_PREVIEW_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), QUILTER_WIDGETS_TYPE_PREVIEW, QuilterWidgetsPreviewClass))

typedef struct _QuilterWidgetsPreview QuilterWidgetsPreview;
typedef struct _QuilterWidgetsPreviewClass QuilterWidgetsPreviewClass;
typedef struct _QuilterWidgetsPreviewPrivate QuilterWidgetsPreviewPrivate;

#define QUILTER_WIDGETS_TYPE_EDIT_VIEW (quilter_widgets_edit_view_get_type ())
#define QUILTER_WIDGETS_EDIT_VIEW(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), QUILTER_WIDGETS_TYPE_EDIT_VIEW, QuilterWidgetsEditView))
#define QUILTER_WIDGETS_EDIT_VIEW_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), QUILTER_WIDGETS_TYPE_EDIT_VIEW, QuilterWidgetsEditViewClass))
#define QUILTER_WIDGETS_IS_EDIT_VIEW(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), QUILTER_WIDGETS_TYPE_EDIT_VIEW))
#define QUILTER_WIDGETS_IS_EDIT_VIEW_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), QUILTER_WIDGETS_TYPE_EDIT_VIEW))
#define QUILTER_WIDGETS_EDIT_VIEW_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), QUILTER_WIDGETS_TYPE_EDIT_VIEW, QuilterWidgetsEditViewClass))

typedef struct _QuilterWidgetsEditView QuilterWidgetsEditView;
typedef struct _QuilterWidgetsEditViewClass QuilterWidgetsEditViewClass;
enum  {
	QUILTER_WIDGETS_PREVIEW_0_PROPERTY,
	QUILTER_WIDGETS_PREVIEW_SCROLL_VALUE_PROPERTY,
	QUILTER_WIDGETS_PREVIEW_NUM_PROPERTIES
};
static GParamSpec* quilter_widgets_preview_properties[QUILTER_WIDGETS_PREVIEW_NUM_PROPERTIES];
#define _g_object_unref0(var) ((var == NULL) ? NULL : (var = (g_object_unref (var), NULL)))
#define _g_free0(var) (var = (g_free (var), NULL))

#define QUILTER_TYPE_MAIN_WINDOW (quilter_main_window_get_type ())
#define QUILTER_MAIN_WINDOW(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), QUILTER_TYPE_MAIN_WINDOW, QuilterMainWindow))
#define QUILTER_MAIN_WINDOW_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), QUILTER_TYPE_MAIN_WINDOW, QuilterMainWindowClass))
#define QUILTER_IS_MAIN_WINDOW(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), QUILTER_TYPE_MAIN_WINDOW))
#define QUILTER_IS_MAIN_WINDOW_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), QUILTER_TYPE_MAIN_WINDOW))
#define QUILTER_MAIN_WINDOW_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), QUILTER_TYPE_MAIN_WINDOW, QuilterMainWindowClass))

typedef struct _QuilterMainWindow QuilterMainWindow;
typedef struct _QuilterMainWindowClass QuilterMainWindowClass;
typedef struct _QuilterMainWindowPrivate QuilterMainWindowPrivate;

#define QUILTER_WIDGETS_TYPE_HEADERBAR (quilter_widgets_headerbar_get_type ())
#define QUILTER_WIDGETS_HEADERBAR(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), QUILTER_WIDGETS_TYPE_HEADERBAR, QuilterWidgetsHeaderbar))
#define QUILTER_WIDGETS_HEADERBAR_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), QUILTER_WIDGETS_TYPE_HEADERBAR, QuilterWidgetsHeaderbarClass))
#define QUILTER_WIDGETS_IS_HEADERBAR(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), QUILTER_WIDGETS_TYPE_HEADERBAR))
#define QUILTER_WIDGETS_IS_HEADERBAR_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), QUILTER_WIDGETS_TYPE_HEADERBAR))
#define QUILTER_WIDGETS_HEADERBAR_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), QUILTER_WIDGETS_TYPE_HEADERBAR, QuilterWidgetsHeaderbarClass))

typedef struct _QuilterWidgetsHeaderbar QuilterWidgetsHeaderbar;
typedef struct _QuilterWidgetsHeaderbarClass QuilterWidgetsHeaderbarClass;

#define QUILTER_WIDGETS_TYPE_SEARCH_BAR (quilter_widgets_search_bar_get_type ())
#define QUILTER_WIDGETS_SEARCH_BAR(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), QUILTER_WIDGETS_TYPE_SEARCH_BAR, QuilterWidgetsSearchBar))
#define QUILTER_WIDGETS_SEARCH_BAR_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), QUILTER_WIDGETS_TYPE_SEARCH_BAR, QuilterWidgetsSearchBarClass))
#define QUILTER_WIDGETS_IS_SEARCH_BAR(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), QUILTER_WIDGETS_TYPE_SEARCH_BAR))
#define QUILTER_WIDGETS_IS_SEARCH_BAR_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), QUILTER_WIDGETS_TYPE_SEARCH_BAR))
#define QUILTER_WIDGETS_SEARCH_BAR_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), QUILTER_WIDGETS_TYPE_SEARCH_BAR, QuilterWidgetsSearchBarClass))

typedef struct _QuilterWidgetsSearchBar QuilterWidgetsSearchBar;
typedef struct _QuilterWidgetsSearchBarClass QuilterWidgetsSearchBarClass;

#define QUILTER_WIDGETS_TYPE_SIDE_BAR (quilter_widgets_side_bar_get_type ())
#define QUILTER_WIDGETS_SIDE_BAR(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), QUILTER_WIDGETS_TYPE_SIDE_BAR, QuilterWidgetsSideBar))
#define QUILTER_WIDGETS_SIDE_BAR_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), QUILTER_WIDGETS_TYPE_SIDE_BAR, QuilterWidgetsSideBarClass))
#define QUILTER_WIDGETS_IS_SIDE_BAR(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), QUILTER_WIDGETS_TYPE_SIDE_BAR))
#define QUILTER_WIDGETS_IS_SIDE_BAR_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), QUILTER_WIDGETS_TYPE_SIDE_BAR))
#define QUILTER_WIDGETS_SIDE_BAR_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), QUILTER_WIDGETS_TYPE_SIDE_BAR, QuilterWidgetsSideBarClass))

typedef struct _QuilterWidgetsSideBar QuilterWidgetsSideBar;
typedef struct _QuilterWidgetsSideBarClass QuilterWidgetsSideBarClass;

#define QUILTER_WIDGETS_TYPE_STATUS_BAR (quilter_widgets_status_bar_get_type ())
#define QUILTER_WIDGETS_STATUS_BAR(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), QUILTER_WIDGETS_TYPE_STATUS_BAR, QuilterWidgetsStatusBar))
#define QUILTER_WIDGETS_STATUS_BAR_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), QUILTER_WIDGETS_TYPE_STATUS_BAR, QuilterWidgetsStatusBarClass))
#define QUILTER_WIDGETS_IS_STATUS_BAR(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), QUILTER_WIDGETS_TYPE_STATUS_BAR))
#define QUILTER_WIDGETS_IS_STATUS_BAR_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), QUILTER_WIDGETS_TYPE_STATUS_BAR))
#define QUILTER_WIDGETS_STATUS_BAR_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), QUILTER_WIDGETS_TYPE_STATUS_BAR, QuilterWidgetsStatusBarClass))

typedef struct _QuilterWidgetsStatusBar QuilterWidgetsStatusBar;
typedef struct _QuilterWidgetsStatusBarClass QuilterWidgetsStatusBarClass;
#define _g_error_free0(var) ((var == NULL) ? NULL : (var = (g_error_free (var), NULL)))
#define _mkd_cleanup0(var) ((var == NULL) ? NULL : (var = (mkd_cleanup (var), NULL)))

#define QUILTER_PLUGINS_TYPE_PLUGIN_MANAGER (quilter_plugins_plugin_manager_get_type ())
#define QUILTER_PLUGINS_PLUGIN_MANAGER(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), QUILTER_PLUGINS_TYPE_PLUGIN_MANAGER, QuilterPluginsPluginManager))
#define QUILTER_PLUGINS_PLUGIN_MANAGER_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), QUILTER_PLUGINS_TYPE_PLUGIN_MANAGER, QuilterPluginsPluginManagerClass))
#define QUILTER_PLUGINS_IS_PLUGIN_MANAGER(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), QUILTER_PLUGINS_TYPE_PLUGIN_MANAGER))
#define QUILTER_PLUGINS_IS_PLUGIN_MANAGER_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), QUILTER_PLUGINS_TYPE_PLUGIN_MANAGER))
#define QUILTER_PLUGINS_PLUGIN_MANAGER_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), QUILTER_PLUGINS_TYPE_PLUGIN_MANAGER, QuilterPluginsPluginManagerClass))

typedef struct _QuilterPluginsPluginManager QuilterPluginsPluginManager;
typedef struct _QuilterPluginsPluginManagerClass QuilterPluginsPluginManagerClass;

#define QUILTER_PLUGINS_TYPE_PLUGIN (quilter_plugins_plugin_get_type ())
#define QUILTER_PLUGINS_PLUGIN(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), QUILTER_PLUGINS_TYPE_PLUGIN, QuilterPluginsPlugin))
#define QUILTER_PLUGINS_PLUGIN_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), QUILTER_PLUGINS_TYPE_PLUGIN, QuilterPluginsPluginClass))
#define QUILTER_PLUGINS_IS_PLUGIN(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), QUILTER_PLUGINS_TYPE_PLUGIN))
#define QUILTER_PLUGINS_IS_PLUGIN_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), QUILTER_PLUGINS_TYPE_PLUGIN))
#define QUILTER_PLUGINS_PLUGIN_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), QUILTER_PLUGINS_TYPE_PLUGIN, QuilterPluginsPluginClass))

typedef struct _QuilterPluginsPlugin QuilterPluginsPlugin;
typedef struct _QuilterPluginsPluginClass QuilterPluginsPluginClass;

struct _QuilterWidgetsPreview {
	WebKitWebView parent_instance;
	QuilterWidgetsPreviewPrivate * priv;
	QuilterWidgetsEditView* buf;
	gchar* html;
};

struct _QuilterWidgetsPreviewClass {
	WebKitWebViewClass parent_class;
};

struct _QuilterMainWindow {
	HdyApplicationWindow parent_instance;
	QuilterMainWindowPrivate * priv;
	GtkAdjustment* eadj;
	GtkBox* box;
	GtkBox* main_leaf;
	GtkOverlay* overlay_editor;
	GtkButton* focus_overlay_button;
	HdyLeaflet* grid;
	HdyLeaflet* header;
	HdyTitleBar* window_header;
	HdyHeaderBar* welcome_titlebar;
	GtkGrid* main_pane;
	GtkGrid* welcome_view;
	GtkMenuButton* set_font_menu;
	GtkPaned* paned;
	GtkRevealer* titlebar_revealer;
	GtkRevealer* overlay_button_revealer;
	GtkScrolledWindow* edit_view;
	GtkStack* main_stack;
	GtkStack* stack;
	GtkStack* titlebar_stack;
	GtkStack* win_stack;
	GtkSeparator* separator;
	GtkSeparator* separator2;
	QuilterWidgetsEditView* edit_view_content;
	QuilterWidgetsHeaderbar* titlebar;
	QuilterWidgetsPreview* preview_view_content;
	QuilterWidgetsSearchBar* searchbar;
	QuilterWidgetsSideBar* sidebar;
	QuilterWidgetsStatusBar* statusbar;
};

struct _QuilterMainWindowClass {
	HdyApplicationWindowClass parent_class;
};

static gpointer quilter_widgets_preview_parent_class = NULL;
static QuilterWidgetsPreview* quilter_widgets_preview_instance;
static QuilterWidgetsPreview* quilter_widgets_preview_instance = NULL;
extern QuilterMainWindow* quilter_application_win;
extern GSettings* quilter_application_gsettings;

GType quilter_widgets_preview_get_type (void) G_GNUC_CONST;
G_DEFINE_AUTOPTR_CLEANUP_FUNC (QuilterWidgetsPreview, g_object_unref)
GType quilter_widgets_edit_view_get_type (void) G_GNUC_CONST;
G_DEFINE_AUTOPTR_CLEANUP_FUNC (QuilterWidgetsEditView, g_object_unref)
QuilterWidgetsPreview* quilter_widgets_preview_get_instance (void);
GType quilter_main_window_get_type (void) G_GNUC_CONST;
G_DEFINE_AUTOPTR_CLEANUP_FUNC (QuilterMainWindow, g_object_unref)
GType quilter_widgets_headerbar_get_type (void) G_GNUC_CONST;
G_DEFINE_AUTOPTR_CLEANUP_FUNC (QuilterWidgetsHeaderbar, g_object_unref)
GType quilter_widgets_search_bar_get_type (void) G_GNUC_CONST;
G_DEFINE_AUTOPTR_CLEANUP_FUNC (QuilterWidgetsSearchBar, g_object_unref)
GType quilter_widgets_side_bar_get_type (void) G_GNUC_CONST;
G_DEFINE_AUTOPTR_CLEANUP_FUNC (QuilterWidgetsSideBar, g_object_unref)
GType quilter_widgets_status_bar_get_type (void) G_GNUC_CONST;
G_DEFINE_AUTOPTR_CLEANUP_FUNC (QuilterWidgetsStatusBar, g_object_unref)
QuilterWidgetsPreview* quilter_widgets_preview_new (QuilterMainWindow* window,
                                                    QuilterWidgetsEditView* buf);
QuilterWidgetsPreview* quilter_widgets_preview_construct (GType object_type,
                                                          QuilterMainWindow* window,
                                                          QuilterWidgetsEditView* buf);
void quilter_widgets_preview_set_scroll_value (QuilterWidgetsPreview* self,
                                               gdouble value);
void quilter_widgets_preview_update_html_view (QuilterWidgetsPreview* self);
static void quilter_widgets_preview_connect_signals (QuilterWidgetsPreview* self);
static gboolean quilter_widgets_preview_real_context_menu (WebKitWebView* base,
                                                    WebKitContextMenu* context_menu,
                                                    GdkEvent* event,
                                                    WebKitHitTestResult* hit_test_result);
static gchar* quilter_widgets_preview_set_stylesheet (QuilterWidgetsPreview* self);
#define QUILTER_STYLES_QUILTERDARK_css "\n" \
"    html {\n" \
"      font-size: 13pt;\n" \
"      width: 100%;\n" \
"      margin: 0 auto;\n" \
"    }\n" \
"\n" \
"    p {\n" \
"      font-size: 13pt;\n" \
"      line-height: 1.618rem;\n" \
"      color: #C3C3C1;\n" \
"    }\n" \
"\n" \
"    h1,\n" \
"    h2,\n" \
"    h3,\n" \
"    h4,\n" \
"    h5,\n" \
"    h6 {\n" \
"      font-style: bold;\n" \
"      margin-top: 1em;\n" \
"      line-height: 1.618rem;\n" \
"    }\n" \
"\n" \
"    h1 {\n" \
"      font-size: 2em;\n" \
"      text-transform: uppercase;\n" \
"    }\n" \
"\n" \
"    h2 {\n" \
"      font-size: 1.5em;\n" \
"    }\n" \
"\n" \
"    h3 {\n" \
"      font-size: 1.17em;\n" \
"    }\n" \
"\n" \
"    h4 {\n" \
"      font-size: 1.12em;\n" \
"    }\n" \
"\n" \
"    h5 {\n" \
"      font-size: .83em;\n" \
"    }\n" \
"\n" \
"    h6 {\n" \
"      font-size: .75em;\n" \
"    }\n" \
"\n" \
"    small {\n" \
"      font-size: .7em;\n" \
"    }\n" \
"\n" \
"    img,\n" \
"    canvas,\n" \
"    iframe,\n" \
"    video,\n" \
"    select,\n" \
"    textarea {\n" \
"      display: block;\n" \
"      max-width: 50%;\n" \
"    }\n" \
"\n" \
"    body {\n" \
"      color: #C3C3C3;\n" \
"      background-color: #111111;\n" \
"      font-weight: 400;\n" \
"      line-height: 1.618rem;\n" \
"      margin-left: 3rem;\n" \
"      margin-right: 3rem;\n" \
"      margin-top: 3rem;\n" \
"      margin-bottom: 3rem;\n" \
"      text-align: left;\n" \
"    }\n" \
"\n" \
"    table {\n" \
"      border-spacing: 0;\n" \
"      border-collapse: collapse;\n" \
"      margin-top: 0;\n" \
"      margin-bottom: 16px;\n" \
"    }\n" \
"\n" \
"    table th {\n" \
"      font-weight: bold;\n" \
"      background-color: #2b2b2b;\n" \
"    }\n" \
"\n" \
"    table th,\n" \
"    table td {\n" \
"      padding: 8px 13px;\n" \
"      border: 1px solid #2b2b2b;\n" \
"    }\n" \
"\n" \
"    table tr {\n" \
"      border-top: 1px solid #2b2b2b;\n" \
"    }\n" \
"\n" \
"    img {\n" \
"      height: auto;\n" \
"      margin: 0 auto;\n" \
"    }\n" \
"\n" \
"    a,\n" \
"    a:visited,\n" \
"    a:hover,\n" \
"    a:focus,\n" \
"    a:active {\n" \
"      color: #1d99f3;\n" \
"    }\n" \
"\n" \
"    code{\n" \
"      display: inline-block;\n" \
"      padding: 0 0.25rem;\n" \
"      background-color: #23241c;\n" \
"      border: 1px solid #23241c;\n" \
"      border-radius: 4px;\n" \
"      font-family: 'Quilt Mono', monospace;\n" \
"      font-weight: normal;\n" \
"    }\n" \
"\n" \
"    pre code{\n" \
"      display: block;\n" \
"      margin: 1rem auto;\n" \
"      overflow-x: scroll;\n" \
"      padding: 0.5em;\n" \
"    }\n" \
"\n" \
"    blockquote {\n" \
"      margin: 0;\n" \
"      border-left: 5px solid #7E8087;\n" \
"      font-style: italic;\n" \
"      padding-left: .8rem;\n" \
"      margin-left: .8rem;\n" \
"      text-align: left;\n" \
"    }\n" \
"\n" \
"    blockquote > p {\n" \
"      color: inherit;\n" \
"      margin-top: 20px;\n" \
"      margin-bottom: 20px;\n" \
"      padding-top: 20px;\n" \
"      padding-bottom: 20px;\n" \
"    }\n" \
"\n" \
"    ul {\n" \
"      list-style: disc;\n" \
"    }\n" \
"\n" \
"    ul>li {\n" \
"      font-size: 18px;\n" \
"    }\n" \
"\n" \
"    hr {\n" \
"      overflow: visible;\n" \
"      padding: 0;\n" \
"      border: none;\n" \
"      color: inherit;\n" \
"      text-align: center;\n" \
"    }\n" \
"    hr:after {\n" \
"      content: \"...\";\n" \
"      letter-spacing: .6em;\n" \
"      display: inline-block;\n" \
"      position: relative;\n" \
"      top: -0.3rem;\n" \
"      font-size: 1.65em;\n" \
"      padding: 0 0.25em;\n" \
"      background: inherit;\n" \
"    }\n" \
"  "
#define QUILTER_STYLES_QUILTERSEPIA_css "\n" \
"    html {\n" \
"      font-size: 13pt;\n" \
"      width: 100%;\n" \
"      margin: 0 auto;\n" \
"    }\n" \
"\n" \
"    p {\n" \
"      font-size: 13pt;\n" \
"      line-height: 1.618rem;\n" \
"      color: #3b3228;\n" \
"    }\n" \
"\n" \
"    h1,\n" \
"    h2,\n" \
"    h3,\n" \
"    h4,\n" \
"    h5,\n" \
"    h6 {\n" \
"      font-style: bold;\n" \
"      margin-top: 1em;\n" \
"      line-height: 1.618rem;\n" \
"    }\n" \
"\n" \
"    h1 {\n" \
"      font-size: 2em;\n" \
"      text-transform: uppercase;\n" \
"    }\n" \
"\n" \
"    h2 {\n" \
"      font-size: 1.5em;\n" \
"    }\n" \
"\n" \
"    h3 {\n" \
"      font-size: 1.17em;\n" \
"    }\n" \
"\n" \
"    h4 {\n" \
"      font-size: 1.12em;\n" \
"    }\n" \
"\n" \
"    h5 {\n" \
"      font-size: .83em;\n" \
"    }\n" \
"\n" \
"    h6 {\n" \
"      font-size: .75em;\n" \
"    }\n" \
"\n" \
"    small {\n" \
"      font-size: .7em;\n" \
"    }\n" \
"\n" \
"    img,\n" \
"    canvas,\n" \
"    iframe,\n" \
"    video,\n" \
"    select,\n" \
"    textarea {\n" \
"      display: block;\n" \
"      max-width: 50%;\n" \
"    }\n" \
"\n" \
"    body {\n" \
"      color: #3b3228;\n" \
"      background-color: #f8f4ef;\n" \
"      font-weight: 400;\n" \
"      line-height: 1.618rem;\n" \
"      margin-left: 3rem;\n" \
"      margin-right: 3rem;\n" \
"      margin-top: 3rem;\n" \
"      margin-bottom: 3rem;\n" \
"      text-align: left;\n" \
"    }\n" \
"\n" \
"    table {\n" \
"      border-spacing: 0;\n" \
"      border-collapse: collapse;\n" \
"      margin-top: 0;\n" \
"      margin-bottom: 16px;\n" \
"    }\n" \
"\n" \
"    table th {\n" \
"      font-weight: bold;\n" \
"      background-color: #e0d0b9;\n" \
"    }\n" \
"\n" \
"    table th,\n" \
"    table td {\n" \
"      padding: 8px 13px;\n" \
"      border: 1px solid #e0d0b9;\n" \
"    }\n" \
"\n" \
"    table tr {\n" \
"      border-top: 1px solid #e0d0b9;\n" \
"    }\n" \
"\n" \
"    img {\n" \
"      height: auto;\n" \
"      margin: 0 auto;\n" \
"    }\n" \
"\n" \
"    a,\n" \
"    a:visited,\n" \
"    a:hover,\n" \
"    a:focus,\n" \
"    a:active {\n" \
"      color: #00897b;\n" \
"    }\n" \
"\n" \
"    code{\n" \
"      display: inline-block;\n" \
"      padding: 0 0.25rem;\n" \
"      background-color: #e0d0b9;\n" \
"      border: 1px solid #e0d0b9;\n" \
"      border-radius: 4px;\n" \
"      font-family: 'Quilt Mono', monospace;\n" \
"      font-weight: normal;\n" \
"    }\n" \
"\n" \
"    pre code{\n" \
"      display: block;\n" \
"      margin: 1rem auto;\n" \
"      overflow-x: scroll;\n" \
"      padding: 0.5em;\n" \
"    }\n" \
"\n" \
"    blockquote {\n" \
"      margin: 0;\n" \
"      border-left: 5px solid #7e6e62;\n" \
"      font-style: italic;\n" \
"      padding-left: .8rem;\n" \
"      margin-left: .8rem;\n" \
"      text-align: left;\n" \
"    }\n" \
"\n" \
"    blockquote > p {\n" \
"      color: inherit;\n" \
"      margin-top: 20px;\n" \
"      margin-bottom: 20px;\n" \
"      padding-top: 20px;\n" \
"      padding-bottom: 20px;\n" \
"    }\n" \
"\n" \
"    ul {\n" \
"      list-style: disc;\n" \
"    }\n" \
"\n" \
"    ul>li {\n" \
"      font-size: 18px;\n" \
"    }\n" \
"\n" \
"    hr {\n" \
"      overflow: visible;\n" \
"      padding: 0;\n" \
"      border: none;\n" \
"      color: inherit;\n" \
"      text-align: center;\n" \
"    }\n" \
"    hr:after {\n" \
"      content: \"...\";\n" \
"      letter-spacing: .6em;\n" \
"      display: inline-block;\n" \
"      position: relative;\n" \
"      top: -0.3rem;\n" \
"      font-size: 1.65em;\n" \
"      padding: 0 0.25em;\n" \
"      background: inherit;\n" \
"    }\n" \
"  "
#define QUILTER_STYLES_QUILTER_css "\n" \
"    html {\n" \
"      font-size: 13pt;\n" \
"      width: 100%;\n" \
"      margin: 0 auto;\n" \
"    }\n" \
"\n" \
"    p {\n" \
"      font-size: 13pt;\n" \
"      line-height: 1.618rem;\n" \
"      color: #191919;\n" \
"    }\n" \
"\n" \
"    h1,\n" \
"    h2,\n" \
"    h3,\n" \
"    h4,\n" \
"    h5,\n" \
"    h6 {\n" \
"      font-style: bold;\n" \
"      margin-top: 1em;\n" \
"      line-height: 1.618rem;\n" \
"    }\n" \
"\n" \
"    h1 {\n" \
"      font-size: 2em;\n" \
"      text-transform: uppercase;\n" \
"    }\n" \
"\n" \
"    h2 {\n" \
"      font-size: 1.5em;\n" \
"    }\n" \
"\n" \
"    h3 {\n" \
"      font-size: 1.17em;\n" \
"    }\n" \
"\n" \
"    h4 {\n" \
"      font-size: 1.12em;\n" \
"    }\n" \
"\n" \
"    h5 {\n" \
"      font-size: .83em;\n" \
"    }\n" \
"\n" \
"    h6 {\n" \
"      font-size: .75em;\n" \
"    }\n" \
"\n" \
"    small {\n" \
"      font-size: .7em;\n" \
"    }\n" \
"\n" \
"    img,\n" \
"    canvas,\n" \
"    iframe,\n" \
"    video,\n" \
"    select,\n" \
"    textarea {\n" \
"      display: block;\n" \
"      max-width: 50%;\n" \
"    }\n" \
"\n" \
"    body {\n" \
"      color: #333;\n" \
"      background-color: #FFF;\n" \
"      line-height: 1.618rem;\n" \
"      margin-left: 3rem;\n" \
"      margin-right: 3rem;\n" \
"      margin-top: 3rem;\n" \
"      margin-bottom: 3rem;\n" \
"    }\n" \
"\n" \
"    table {\n" \
"      border-spacing: 0;\n" \
"      border-collapse: collapse;\n" \
"      margin-top: 0;\n" \
"      margin-bottom: 16px;\n" \
"    }\n" \
"\n" \
"    table th {\n" \
"      font-weight: bold;\n" \
"      background-color: #dddddd;\n" \
"    }\n" \
"\n" \
"    table th,\n" \
"    table td {\n" \
"      padding: 8px 13px;\n" \
"      border: 1px solid #F0F0F0;\n" \
"    }\n" \
"\n" \
"    table tr {\n" \
"      border-top: 1px solid #F0F0F0;\n" \
"    }\n" \
"\n" \
"    img {\n" \
"      height: auto;\n" \
"      margin: 0 auto;\n" \
"    }\n" \
"\n" \
"    a,\n" \
"    a:visited,\n" \
"    a:hover,\n" \
"    a:focus,\n" \
"    a:active {\n" \
"      color: #0073c5;\n" \
"    }\n" \
"\n" \
"    code{\n" \
"      display: inline-block;\n" \
"      padding: 0 0.25rem;\n" \
"      background-color: #F0F0F0;\n" \
"      border: 1px solid #F0F0F0;\n" \
"      border-radius: 4px;\n" \
"      font-family: 'Quilt Mono', monospace;\n" \
"      font-weight: normal;\n" \
"    }\n" \
"\n" \
"    pre code{\n" \
"      display: block;\n" \
"      margin: 1rem auto;\n" \
"      overflow-x: scroll;\n" \
"      padding: 0.5em;\n" \
"    }\n" \
"\n" \
"    blockquote {\n" \
"      margin: 0;\n" \
"      border-left: 5px solid #8d8d8d;\n" \
"      font-style: italic;\n" \
"      padding-left: .8rem;\n" \
"      margin-left: .8rem;\n" \
"      text-align: left;\n" \
"    }\n" \
"\n" \
"    blockquote > p {\n" \
"      color: inherit;\n" \
"      margin-top: 20px;\n" \
"      margin-bottom: 20px;\n" \
"      padding-top: 20px;\n" \
"      padding-bottom: 20px;\n" \
"    }\n" \
"\n" \
"    ul {\n" \
"      list-style: disc;\n" \
"    }\n" \
"\n" \
"    ul>li {\n" \
"      font-size: 18px;\n" \
"    }\n" \
"\n" \
"    hr {\n" \
"      overflow: visible;\n" \
"      padding: 0;\n" \
"      border: none;\n" \
"      color: inherit;\n" \
"      text-align: center;\n" \
"    }\n" \
"    hr:after {\n" \
"      content: \"...\";\n" \
"      letter-spacing: .6em;\n" \
"      display: inline-block;\n" \
"      position: relative;\n" \
"      top: -0.3rem;\n" \
"      font-size: 1.65em;\n" \
"      padding: 0 0.25em;\n" \
"      background: inherit;\n" \
"    }\n" \
"  "
static gchar* quilter_widgets_preview_set_font_stylesheet (QuilterWidgetsPreview* self);
static gchar* quilter_widgets_preview_set_highlight_stylesheet (QuilterWidgetsPreview* self);
static gchar* quilter_widgets_preview_set_highlight (QuilterWidgetsPreview* self);
static gchar* quilter_widgets_preview_set_center_headers (QuilterWidgetsPreview* self);
static gchar* quilter_widgets_preview_set_latex (QuilterWidgetsPreview* self);
static gchar* quilter_widgets_preview_set_mermaid (QuilterWidgetsPreview* self);
static gboolean __lambda4_ (QuilterWidgetsPreview* self,
                     WebKitPolicyDecision* decision,
                     WebKitPolicyDecisionType type);
static void quilter_widgets_preview_launch_browser (QuilterWidgetsPreview* self,
                                             const gchar* url);
static gboolean ___lambda4__webkit_web_view_decide_policy (WebKitWebView* _sender,
                                                    WebKitPolicyDecision* decision,
                                                    WebKitPolicyDecisionType type,
                                                    gpointer self);
static void __lambda5_ (QuilterWidgetsPreview* self,
                 WebKitLoadEvent event);
static void ___lambda5__webkit_web_view_load_changed (WebKitWebView* _sender,
                                               WebKitLoadEvent load_event,
                                               gpointer self);
static gchar** quilter_widgets_preview_process_frontmatter (QuilterWidgetsPreview* self,
                                                     const gchar* raw_mk,
                                                     gchar* * processed_mk,
                                                     gint* result_length1);
static void _vala_array_add5 (gchar** * array,
                       gint* length,
                       gint* size,
                       gchar* value);
static void _vala_array_add6 (gchar** * array,
                       gint* length,
                       gint* size,
                       gchar* value);
gchar* quilter_widgets_edit_view_get_text (QuilterWidgetsEditView* self);
static gchar* quilter_widgets_preview_process_plugins (QuilterWidgetsPreview* self,
                                                const gchar* raw_mk);
GType quilter_plugins_plugin_manager_get_type (void) G_GNUC_CONST;
G_DEFINE_AUTOPTR_CLEANUP_FUNC (QuilterPluginsPluginManager, g_object_unref)
QuilterPluginsPluginManager* quilter_plugins_plugin_manager_get_instance (void);
GType quilter_plugins_plugin_get_type (void) G_GNUC_CONST;
G_DEFINE_AUTOPTR_CLEANUP_FUNC (QuilterPluginsPlugin, g_object_unref)
GList* quilter_plugins_plugin_manager_get_plugs (QuilterPluginsPluginManager* self);
gboolean quilter_plugins_plugin_has_match (QuilterPluginsPlugin* self,
                                           const gchar* text);
gchar* quilter_plugins_plugin_convert (QuilterPluginsPlugin* self,
                                       const gchar* line);
static void _g_object_unref0_ (gpointer var);
static inline void _g_list_free__g_object_unref0_ (GList* self);
static void quilter_widgets_preview_finalize (GObject * obj);
static GType quilter_widgets_preview_get_type_once (void);
static void _vala_quilter_widgets_preview_set_property (GObject * object,
                                                 guint property_id,
                                                 const GValue * value,
                                                 GParamSpec * pspec);
static void _vala_array_destroy (gpointer array,
                          gint array_length,
                          GDestroyNotify destroy_func);
static void _vala_array_free (gpointer array,
                       gint array_length,
                       GDestroyNotify destroy_func);
static gint _vala_array_length (gpointer array);

static gpointer
_g_object_ref0 (gpointer self)
{
#line 47 "../src/Widgets/WebView.vala"
	return self ? g_object_ref (self) : NULL;
#line 294 "WebView.c"
}

QuilterWidgetsPreview*
quilter_widgets_preview_get_instance (void)
{
	QuilterWidgetsPreview* _tmp0_;
	QuilterWidgetsPreview* _tmp5_;
	QuilterWidgetsPreview* _tmp6_;
	QuilterWidgetsPreview* result = NULL;
#line 43 "../src/Widgets/WebView.vala"
	_tmp0_ = quilter_widgets_preview_instance;
#line 43 "../src/Widgets/WebView.vala"
	if (_tmp0_ == NULL) {
#line 308 "WebView.c"
		QuilterMainWindow* _tmp1_;
		QuilterMainWindow* _tmp2_;
		QuilterWidgetsEditView* _tmp3_;
		QuilterWidgetsPreview* _tmp4_;
#line 44 "../src/Widgets/WebView.vala"
		_tmp1_ = quilter_application_win;
#line 44 "../src/Widgets/WebView.vala"
		_tmp2_ = quilter_application_win;
#line 44 "../src/Widgets/WebView.vala"
		_tmp3_ = _tmp2_->edit_view_content;
#line 44 "../src/Widgets/WebView.vala"
		_tmp4_ = quilter_widgets_preview_new (_tmp1_, _tmp3_);
#line 44 "../src/Widgets/WebView.vala"
		g_object_ref_sink (_tmp4_);
#line 44 "../src/Widgets/WebView.vala"
		_g_object_unref0 (quilter_widgets_preview_instance);
#line 44 "../src/Widgets/WebView.vala"
		quilter_widgets_preview_instance = _tmp4_;
#line 327 "WebView.c"
	}
#line 47 "../src/Widgets/WebView.vala"
	_tmp5_ = quilter_widgets_preview_instance;
#line 47 "../src/Widgets/WebView.vala"
	_tmp6_ = _g_object_ref0 (_tmp5_);
#line 47 "../src/Widgets/WebView.vala"
	result = _tmp6_;
#line 47 "../src/Widgets/WebView.vala"
	return result;
#line 337 "WebView.c"
}

QuilterWidgetsPreview*
quilter_widgets_preview_construct (GType object_type,
                                   QuilterMainWindow* window,
                                   QuilterWidgetsEditView* buf)
{
	QuilterWidgetsPreview * self = NULL;
	WebKitUserContentManager* _tmp0_;
	WebKitUserContentManager* _tmp1_;
	QuilterWidgetsEditView* _tmp2_;
	WebKitSettings* webkit_settings = NULL;
	WebKitSettings* _tmp3_;
	WebKitSettings* _tmp4_;
#line 50 "../src/Widgets/WebView.vala"
	g_return_val_if_fail (window != NULL, NULL);
#line 50 "../src/Widgets/WebView.vala"
	g_return_val_if_fail (buf != NULL, NULL);
#line 51 "../src/Widgets/WebView.vala"
	_tmp0_ = webkit_user_content_manager_new ();
#line 51 "../src/Widgets/WebView.vala"
	_tmp1_ = _tmp0_;
#line 51 "../src/Widgets/WebView.vala"
	self = (QuilterWidgetsPreview*) g_object_new (object_type, "user-content-manager", _tmp1_, NULL);
#line 51 "../src/Widgets/WebView.vala"
	_g_object_unref0 (_tmp1_);
#line 52 "../src/Widgets/WebView.vala"
	_tmp2_ = _g_object_ref0 (buf);
#line 52 "../src/Widgets/WebView.vala"
	_g_object_unref0 (self->buf);
#line 52 "../src/Widgets/WebView.vala"
	self->buf = _tmp2_;
#line 53 "../src/Widgets/WebView.vala"
	_tmp3_ = webkit_web_view_get_settings ((WebKitWebView*) self);
#line 53 "../src/Widgets/WebView.vala"
	_tmp4_ = _g_object_ref0 (_tmp3_);
#line 53 "../src/Widgets/WebView.vala"
	webkit_settings = _tmp4_;
#line 54 "../src/Widgets/WebView.vala"
	webkit_settings_set_enable_page_cache (webkit_settings, FALSE);
#line 55 "../src/Widgets/WebView.vala"
	webkit_settings_set_javascript_can_open_windows_automatically (webkit_settings, FALSE);
#line 56 "../src/Widgets/WebView.vala"
	webkit_settings_set_enable_java (webkit_settings, FALSE);
#line 58 "../src/Widgets/WebView.vala"
	quilter_widgets_preview_set_scroll_value (self, (gdouble) -1);
#line 60 "../src/Widgets/WebView.vala"
	quilter_widgets_preview_update_html_view (self);
#line 61 "../src/Widgets/WebView.vala"
	quilter_widgets_preview_connect_signals (self);
#line 50 "../src/Widgets/WebView.vala"
	_g_object_unref0 (webkit_settings);
#line 50 "../src/Widgets/WebView.vala"
	return self;
#line 392 "WebView.c"
}

QuilterWidgetsPreview*
quilter_widgets_preview_new (QuilterMainWindow* window,
                             QuilterWidgetsEditView* buf)
{
#line 50 "../src/Widgets/WebView.vala"
	return quilter_widgets_preview_construct (QUILTER_WIDGETS_TYPE_PREVIEW, window, buf);
#line 401 "WebView.c"
}

static gboolean
quilter_widgets_preview_real_context_menu (WebKitWebView* base,
                                           WebKitContextMenu* context_menu,
                                           GdkEvent* event,
                                           WebKitHitTestResult* hit_test_result)
{
	QuilterWidgetsPreview * self;
	gboolean result = FALSE;
#line 64 "../src/Widgets/WebView.vala"
	self = (QuilterWidgetsPreview*) base;
#line 64 "../src/Widgets/WebView.vala"
	g_return_val_if_fail (context_menu != NULL, FALSE);
#line 64 "../src/Widgets/WebView.vala"
	g_return_val_if_fail (event != NULL, FALSE);
#line 64 "../src/Widgets/WebView.vala"
	g_return_val_if_fail (hit_test_result != NULL, FALSE);
#line 69 "../src/Widgets/WebView.vala"
	result = TRUE;
#line 69 "../src/Widgets/WebView.vala"
	return result;
#line 424 "WebView.c"
}

static gchar*
quilter_widgets_preview_set_stylesheet (QuilterWidgetsPreview* self)
{
	GSettings* _tmp0_;
	gchar* _tmp1_;
	gchar* _tmp2_;
	gboolean _tmp3_;
	gchar* _tmp15_;
	gchar* result = NULL;
#line 72 "../src/Widgets/WebView.vala"
	g_return_val_if_fail (self != NULL, NULL);
#line 73 "../src/Widgets/WebView.vala"
	_tmp0_ = quilter_application_gsettings;
#line 73 "../src/Widgets/WebView.vala"
	_tmp1_ = g_settings_get_string (_tmp0_, "visual-mode");
#line 73 "../src/Widgets/WebView.vala"
	_tmp2_ = _tmp1_;
#line 73 "../src/Widgets/WebView.vala"
	_tmp3_ = g_strcmp0 (_tmp2_, "dark") == 0;
#line 73 "../src/Widgets/WebView.vala"
	_g_free0 (_tmp2_);
#line 73 "../src/Widgets/WebView.vala"
	if (_tmp3_) {
#line 450 "WebView.c"
		gchar* dark = NULL;
		gchar* _tmp4_;
#line 74 "../src/Widgets/WebView.vala"
		_tmp4_ = g_strdup (QUILTER_STYLES_QUILTERDARK_css);
#line 74 "../src/Widgets/WebView.vala"
		dark = _tmp4_;
#line 75 "../src/Widgets/WebView.vala"
		result = dark;
#line 75 "../src/Widgets/WebView.vala"
		return result;
#line 461 "WebView.c"
	} else {
		GSettings* _tmp5_;
		gchar* _tmp6_;
		gchar* _tmp7_;
		gboolean _tmp8_;
#line 76 "../src/Widgets/WebView.vala"
		_tmp5_ = quilter_application_gsettings;
#line 76 "../src/Widgets/WebView.vala"
		_tmp6_ = g_settings_get_string (_tmp5_, "visual-mode");
#line 76 "../src/Widgets/WebView.vala"
		_tmp7_ = _tmp6_;
#line 76 "../src/Widgets/WebView.vala"
		_tmp8_ = g_strcmp0 (_tmp7_, "sepia") == 0;
#line 76 "../src/Widgets/WebView.vala"
		_g_free0 (_tmp7_);
#line 76 "../src/Widgets/WebView.vala"
		if (_tmp8_) {
#line 479 "WebView.c"
			gchar* sepia = NULL;
			gchar* _tmp9_;
#line 77 "../src/Widgets/WebView.vala"
			_tmp9_ = g_strdup (QUILTER_STYLES_QUILTERSEPIA_css);
#line 77 "../src/Widgets/WebView.vala"
			sepia = _tmp9_;
#line 78 "../src/Widgets/WebView.vala"
			result = sepia;
#line 78 "../src/Widgets/WebView.vala"
			return result;
#line 490 "WebView.c"
		} else {
			GSettings* _tmp10_;
			gchar* _tmp11_;
			gchar* _tmp12_;
			gboolean _tmp13_;
#line 79 "../src/Widgets/WebView.vala"
			_tmp10_ = quilter_application_gsettings;
#line 79 "../src/Widgets/WebView.vala"
			_tmp11_ = g_settings_get_string (_tmp10_, "visual-mode");
#line 79 "../src/Widgets/WebView.vala"
			_tmp12_ = _tmp11_;
#line 79 "../src/Widgets/WebView.vala"
			_tmp13_ = g_strcmp0 (_tmp12_, "light") == 0;
#line 79 "../src/Widgets/WebView.vala"
			_g_free0 (_tmp12_);
#line 79 "../src/Widgets/WebView.vala"
			if (_tmp13_) {
#line 508 "WebView.c"
				gchar* normal = NULL;
				gchar* _tmp14_;
#line 80 "../src/Widgets/WebView.vala"
				_tmp14_ = g_strdup (QUILTER_STYLES_QUILTER_css);
#line 80 "../src/Widgets/WebView.vala"
				normal = _tmp14_;
#line 81 "../src/Widgets/WebView.vala"
				result = normal;
#line 81 "../src/Widgets/WebView.vala"
				return result;
#line 519 "WebView.c"
			}
		}
	}
#line 83 "../src/Widgets/WebView.vala"
	_tmp15_ = g_strdup ("");
#line 83 "../src/Widgets/WebView.vala"
	result = _tmp15_;
#line 83 "../src/Widgets/WebView.vala"
	return result;
#line 529 "WebView.c"
}

static gchar*
quilter_widgets_preview_set_font_stylesheet (QuilterWidgetsPreview* self)
{
	GSettings* _tmp0_;
	gchar* _tmp1_;
	gchar* _tmp2_;
	gboolean _tmp3_;
	const gchar* _tmp18_;
	gchar* _tmp19_;
	gchar* result = NULL;
#line 86 "../src/Widgets/WebView.vala"
	g_return_val_if_fail (self != NULL, NULL);
#line 87 "../src/Widgets/WebView.vala"
	_tmp0_ = quilter_application_gsettings;
#line 87 "../src/Widgets/WebView.vala"
	_tmp1_ = g_settings_get_string (_tmp0_, "preview-font");
#line 87 "../src/Widgets/WebView.vala"
	_tmp2_ = _tmp1_;
#line 87 "../src/Widgets/WebView.vala"
	_tmp3_ = g_strcmp0 (_tmp2_, "serif") == 0;
#line 87 "../src/Widgets/WebView.vala"
	_g_free0 (_tmp2_);
#line 87 "../src/Widgets/WebView.vala"
	if (_tmp3_) {
#line 556 "WebView.c"
		const gchar* _tmp4_;
		gchar* _tmp5_;
#line 88 "../src/Widgets/WebView.vala"
		_tmp4_ = g_get_user_data_dir ();
#line 88 "../src/Widgets/WebView.vala"
		_tmp5_ = g_strconcat (_tmp4_, "/io.github.lainsce.Quilter/font/serif.css", NULL);
#line 88 "../src/Widgets/WebView.vala"
		result = _tmp5_;
#line 88 "../src/Widgets/WebView.vala"
		return result;
#line 567 "WebView.c"
	} else {
		GSettings* _tmp6_;
		gchar* _tmp7_;
		gchar* _tmp8_;
		gboolean _tmp9_;
#line 89 "../src/Widgets/WebView.vala"
		_tmp6_ = quilter_application_gsettings;
#line 89 "../src/Widgets/WebView.vala"
		_tmp7_ = g_settings_get_string (_tmp6_, "preview-font");
#line 89 "../src/Widgets/WebView.vala"
		_tmp8_ = _tmp7_;
#line 89 "../src/Widgets/WebView.vala"
		_tmp9_ = g_strcmp0 (_tmp8_, "sans") == 0;
#line 89 "../src/Widgets/WebView.vala"
		_g_free0 (_tmp8_);
#line 89 "../src/Widgets/WebView.vala"
		if (_tmp9_) {
#line 585 "WebView.c"
			const gchar* _tmp10_;
			gchar* _tmp11_;
#line 90 "../src/Widgets/WebView.vala"
			_tmp10_ = g_get_user_data_dir ();
#line 90 "../src/Widgets/WebView.vala"
			_tmp11_ = g_strconcat (_tmp10_, "/io.github.lainsce.Quilter/font/sans.css", NULL);
#line 90 "../src/Widgets/WebView.vala"
			result = _tmp11_;
#line 90 "../src/Widgets/WebView.vala"
			return result;
#line 596 "WebView.c"
		} else {
			GSettings* _tmp12_;
			gchar* _tmp13_;
			gchar* _tmp14_;
			gboolean _tmp15_;
#line 91 "../src/Widgets/WebView.vala"
			_tmp12_ = quilter_application_gsettings;
#line 91 "../src/Widgets/WebView.vala"
			_tmp13_ = g_settings_get_string (_tmp12_, "preview-font");
#line 91 "../src/Widgets/WebView.vala"
			_tmp14_ = _tmp13_;
#line 91 "../src/Widgets/WebView.vala"
			_tmp15_ = g_strcmp0 (_tmp14_, "mono") == 0;
#line 91 "../src/Widgets/WebView.vala"
			_g_free0 (_tmp14_);
#line 91 "../src/Widgets/WebView.vala"
			if (_tmp15_) {
#line 614 "WebView.c"
				const gchar* _tmp16_;
				gchar* _tmp17_;
#line 92 "../src/Widgets/WebView.vala"
				_tmp16_ = g_get_user_data_dir ();
#line 92 "../src/Widgets/WebView.vala"
				_tmp17_ = g_strconcat (_tmp16_, "/io.github.lainsce.Quilter/font/mono.css", NULL);
#line 92 "../src/Widgets/WebView.vala"
				result = _tmp17_;
#line 92 "../src/Widgets/WebView.vala"
				return result;
#line 625 "WebView.c"
			}
		}
	}
#line 95 "../src/Widgets/WebView.vala"
	_tmp18_ = g_get_user_data_dir ();
#line 95 "../src/Widgets/WebView.vala"
	_tmp19_ = g_strconcat (_tmp18_, "/io.github.lainsce.Quilter/font/serif.css", NULL);
#line 95 "../src/Widgets/WebView.vala"
	result = _tmp19_;
#line 95 "../src/Widgets/WebView.vala"
	return result;
#line 637 "WebView.c"
}

static gchar*
quilter_widgets_preview_set_highlight_stylesheet (QuilterWidgetsPreview* self)
{
	GSettings* _tmp0_;
	gchar* _tmp1_;
	gchar* _tmp2_;
	gboolean _tmp3_;
	gchar* result = NULL;
#line 98 "../src/Widgets/WebView.vala"
	g_return_val_if_fail (self != NULL, NULL);
#line 99 "../src/Widgets/WebView.vala"
	_tmp0_ = quilter_application_gsettings;
#line 99 "../src/Widgets/WebView.vala"
	_tmp1_ = g_settings_get_string (_tmp0_, "visual-mode");
#line 99 "../src/Widgets/WebView.vala"
	_tmp2_ = _tmp1_;
#line 99 "../src/Widgets/WebView.vala"
	_tmp3_ = g_strcmp0 (_tmp2_, "dark") == 0;
#line 99 "../src/Widgets/WebView.vala"
	_g_free0 (_tmp2_);
#line 99 "../src/Widgets/WebView.vala"
	if (_tmp3_) {
#line 662 "WebView.c"
		const gchar* _tmp4_;
		gchar* _tmp5_;
#line 100 "../src/Widgets/WebView.vala"
		_tmp4_ = g_get_user_data_dir ();
#line 100 "../src/Widgets/WebView.vala"
		_tmp5_ = g_strconcat (_tmp4_, "/io.github.lainsce.Quilter/highlight.js/styles/dark.min.css", NULL);
#line 100 "../src/Widgets/WebView.vala"
		result = _tmp5_;
#line 100 "../src/Widgets/WebView.vala"
		return result;
#line 673 "WebView.c"
	} else {
		GSettings* _tmp6_;
		gchar* _tmp7_;
		gchar* _tmp8_;
		gboolean _tmp9_;
#line 101 "../src/Widgets/WebView.vala"
		_tmp6_ = quilter_application_gsettings;
#line 101 "../src/Widgets/WebView.vala"
		_tmp7_ = g_settings_get_string (_tmp6_, "visual-mode");
#line 101 "../src/Widgets/WebView.vala"
		_tmp8_ = _tmp7_;
#line 101 "../src/Widgets/WebView.vala"
		_tmp9_ = g_strcmp0 (_tmp8_, "sepia") == 0;
#line 101 "../src/Widgets/WebView.vala"
		_g_free0 (_tmp8_);
#line 101 "../src/Widgets/WebView.vala"
		if (_tmp9_) {
#line 691 "WebView.c"
			const gchar* _tmp10_;
			gchar* _tmp11_;
#line 102 "../src/Widgets/WebView.vala"
			_tmp10_ = g_get_user_data_dir ();
#line 102 "../src/Widgets/WebView.vala"
			_tmp11_ = g_strconcat (_tmp10_, "/io.github.lainsce.Quilter/highlight.js/styles/sepia.min.css", NULL);
#line 102 "../src/Widgets/WebView.vala"
			result = _tmp11_;
#line 102 "../src/Widgets/WebView.vala"
			return result;
#line 702 "WebView.c"
		} else {
			GSettings* _tmp12_;
			gchar* _tmp13_;
			gchar* _tmp14_;
			gboolean _tmp15_;
#line 103 "../src/Widgets/WebView.vala"
			_tmp12_ = quilter_application_gsettings;
#line 103 "../src/Widgets/WebView.vala"
			_tmp13_ = g_settings_get_string (_tmp12_, "visual-mode");
#line 103 "../src/Widgets/WebView.vala"
			_tmp14_ = _tmp13_;
#line 103 "../src/Widgets/WebView.vala"
			_tmp15_ = g_strcmp0 (_tmp14_, "light") == 0;
#line 103 "../src/Widgets/WebView.vala"
			_g_free0 (_tmp14_);
#line 103 "../src/Widgets/WebView.vala"
			if (_tmp15_) {
#line 720 "WebView.c"
				const gchar* _tmp16_;
				gchar* _tmp17_;
#line 104 "../src/Widgets/WebView.vala"
				_tmp16_ = g_get_user_data_dir ();
#line 104 "../src/Widgets/WebView.vala"
				_tmp17_ = g_strconcat (_tmp16_, "/io.github.lainsce.Quilter/highlight.js/styles/default.min.css", NULL);
#line 104 "../src/Widgets/WebView.vala"
				result = _tmp17_;
#line 104 "../src/Widgets/WebView.vala"
				return result;
#line 731 "WebView.c"
			} else {
				gchar* _tmp18_;
#line 106 "../src/Widgets/WebView.vala"
				_tmp18_ = g_strdup ("");
#line 106 "../src/Widgets/WebView.vala"
				result = _tmp18_;
#line 106 "../src/Widgets/WebView.vala"
				return result;
#line 740 "WebView.c"
			}
		}
	}
}

static gchar*
quilter_widgets_preview_set_highlight (QuilterWidgetsPreview* self)
{
	GSettings* _tmp0_;
	gchar* result = NULL;
#line 111 "../src/Widgets/WebView.vala"
	g_return_val_if_fail (self != NULL, NULL);
#line 112 "../src/Widgets/WebView.vala"
	_tmp0_ = quilter_application_gsettings;
#line 112 "../src/Widgets/WebView.vala"
	if (g_settings_get_boolean (_tmp0_, "highlight")) {
#line 757 "WebView.c"
		gchar* render = NULL;
		const gchar* _tmp1_;
		gchar* _tmp2_;
		gchar* hl = NULL;
		gchar* _tmp3_;
		gchar* _tmp4_;
		const gchar* _tmp5_;
		gchar* _tmp6_;
		gchar* _tmp7_;
#line 113 "../src/Widgets/WebView.vala"
		_tmp1_ = g_get_user_data_dir ();
#line 113 "../src/Widgets/WebView.vala"
		_tmp2_ = g_strconcat (_tmp1_, "/io.github.lainsce.Quilter/highlight.js/lib/highlight.min.js", NULL);
#line 113 "../src/Widgets/WebView.vala"
		render = _tmp2_;
#line 114 "../src/Widgets/WebView.vala"
		_tmp3_ = quilter_widgets_preview_set_highlight_stylesheet (self);
#line 114 "../src/Widgets/WebView.vala"
		_tmp4_ = _tmp3_;
#line 114 "../src/Widgets/WebView.vala"
		_tmp5_ = render;
#line 114 "../src/Widgets/WebView.vala"
		_tmp6_ = g_strdup_printf ("\n" \
"                    <link rel=\"stylesheet\" href=\"%s\">\n" \
"                    <script defer src=\"%s\" onload=\"hljs.initHighlig" \
"htingOnLoad();\"></script>\n" \
"                ", _tmp4_, _tmp5_);
#line 114 "../src/Widgets/WebView.vala"
		_tmp7_ = _tmp6_;
#line 114 "../src/Widgets/WebView.vala"
		_g_free0 (_tmp4_);
#line 114 "../src/Widgets/WebView.vala"
		hl = _tmp7_;
#line 118 "../src/Widgets/WebView.vala"
		result = hl;
#line 118 "../src/Widgets/WebView.vala"
		_g_free0 (render);
#line 118 "../src/Widgets/WebView.vala"
		return result;
#line 793 "WebView.c"
	} else {
		gchar* _tmp8_;
#line 120 "../src/Widgets/WebView.vala"
		_tmp8_ = g_strdup ("");
#line 120 "../src/Widgets/WebView.vala"
		result = _tmp8_;
#line 120 "../src/Widgets/WebView.vala"
		return result;
#line 802 "WebView.c"
	}
}

static gchar*
quilter_widgets_preview_set_center_headers (QuilterWidgetsPreview* self)
{
	GSettings* _tmp0_;
	gchar* result = NULL;
#line 124 "../src/Widgets/WebView.vala"
	g_return_val_if_fail (self != NULL, NULL);
#line 125 "../src/Widgets/WebView.vala"
	_tmp0_ = quilter_application_gsettings;
#line 125 "../src/Widgets/WebView.vala"
	if (g_settings_get_boolean (_tmp0_, "center-headers")) {
#line 817 "WebView.c"
		const gchar* _tmp1_;
		gchar* _tmp2_;
#line 126 "../src/Widgets/WebView.vala"
		_tmp1_ = g_get_user_data_dir ();
#line 126 "../src/Widgets/WebView.vala"
		_tmp2_ = g_strconcat (_tmp1_, "/io.github.lainsce.Quilter/center_headers/cheaders.css", NULL);
#line 126 "../src/Widgets/WebView.vala"
		result = _tmp2_;
#line 126 "../src/Widgets/WebView.vala"
		return result;
#line 828 "WebView.c"
	} else {
		gchar* _tmp3_;
#line 128 "../src/Widgets/WebView.vala"
		_tmp3_ = g_strdup ("");
#line 128 "../src/Widgets/WebView.vala"
		result = _tmp3_;
#line 128 "../src/Widgets/WebView.vala"
		return result;
#line 837 "WebView.c"
	}
}

static gchar*
quilter_widgets_preview_set_latex (QuilterWidgetsPreview* self)
{
	GSettings* _tmp0_;
	gchar* result = NULL;
#line 132 "../src/Widgets/WebView.vala"
	g_return_val_if_fail (self != NULL, NULL);
#line 133 "../src/Widgets/WebView.vala"
	_tmp0_ = quilter_application_gsettings;
#line 133 "../src/Widgets/WebView.vala"
	if (g_settings_get_boolean (_tmp0_, "latex")) {
#line 852 "WebView.c"
		gchar* katex_main = NULL;
		const gchar* _tmp1_;
		gchar* _tmp2_;
		gchar* katex_js = NULL;
		const gchar* _tmp3_;
		gchar* _tmp4_;
		gchar* render = NULL;
		const gchar* _tmp5_;
		gchar* _tmp6_;
		gchar* latex = NULL;
		const gchar* _tmp7_;
		const gchar* _tmp8_;
		const gchar* _tmp9_;
		gchar* _tmp10_;
#line 134 "../src/Widgets/WebView.vala"
		_tmp1_ = g_get_user_data_dir ();
#line 134 "../src/Widgets/WebView.vala"
		_tmp2_ = g_strconcat (_tmp1_, "/io.github.lainsce.Quilter/katex/katex.css", NULL);
#line 134 "../src/Widgets/WebView.vala"
		katex_main = _tmp2_;
#line 135 "../src/Widgets/WebView.vala"
		_tmp3_ = g_get_user_data_dir ();
#line 135 "../src/Widgets/WebView.vala"
		_tmp4_ = g_strconcat (_tmp3_, "/io.github.lainsce.Quilter/katex/katex.js", NULL);
#line 135 "../src/Widgets/WebView.vala"
		katex_js = _tmp4_;
#line 136 "../src/Widgets/WebView.vala"
		_tmp5_ = g_get_user_data_dir ();
#line 136 "../src/Widgets/WebView.vala"
		_tmp6_ = g_strconcat (_tmp5_, "/io.github.lainsce.Quilter/katex/render.js", NULL);
#line 136 "../src/Widgets/WebView.vala"
		render = _tmp6_;
#line 137 "../src/Widgets/WebView.vala"
		_tmp7_ = katex_main;
#line 137 "../src/Widgets/WebView.vala"
		_tmp8_ = katex_js;
#line 137 "../src/Widgets/WebView.vala"
		_tmp9_ = render;
#line 137 "../src/Widgets/WebView.vala"
		_tmp10_ = g_strdup_printf ("\n" \
"                    <link rel=\"stylesheet\" href=\"%s\">\n" \
"                    <script defer src=\"%s\"></script>\n" \
"                    <script defer src=\"%s\" onload=\"renderMathInElem" \
"ent(document.body);\"></script>\n" \
"                ", _tmp7_, _tmp8_, _tmp9_);
#line 137 "../src/Widgets/WebView.vala"
		latex = _tmp10_;
#line 142 "../src/Widgets/WebView.vala"
		result = latex;
#line 142 "../src/Widgets/WebView.vala"
		_g_free0 (render);
#line 142 "../src/Widgets/WebView.vala"
		_g_free0 (katex_js);
#line 142 "../src/Widgets/WebView.vala"
		_g_free0 (katex_main);
#line 142 "../src/Widgets/WebView.vala"
		return result;
#line 905 "WebView.c"
	} else {
		gchar* _tmp11_;
#line 144 "../src/Widgets/WebView.vala"
		_tmp11_ = g_strdup ("");
#line 144 "../src/Widgets/WebView.vala"
		result = _tmp11_;
#line 144 "../src/Widgets/WebView.vala"
		return result;
#line 914 "WebView.c"
	}
}

static gchar*
quilter_widgets_preview_set_mermaid (QuilterWidgetsPreview* self)
{
	GSettings* _tmp0_;
	gchar* result = NULL;
#line 148 "../src/Widgets/WebView.vala"
	g_return_val_if_fail (self != NULL, NULL);
#line 149 "../src/Widgets/WebView.vala"
	_tmp0_ = quilter_application_gsettings;
#line 149 "../src/Widgets/WebView.vala"
	if (g_settings_get_boolean (_tmp0_, "mermaid")) {
#line 929 "WebView.c"
		gchar* render = NULL;
		const gchar* _tmp1_;
		gchar* _tmp2_;
		gchar* mermaid = NULL;
		const gchar* _tmp3_;
		gchar* _tmp4_;
#line 150 "../src/Widgets/WebView.vala"
		_tmp1_ = g_get_user_data_dir ();
#line 150 "../src/Widgets/WebView.vala"
		_tmp2_ = g_strconcat (_tmp1_, "/io.github.lainsce.Quilter/mermaid/mermaid.js", NULL);
#line 150 "../src/Widgets/WebView.vala"
		render = _tmp2_;
#line 151 "../src/Widgets/WebView.vala"
		_tmp3_ = render;
#line 151 "../src/Widgets/WebView.vala"
		_tmp4_ = g_strdup_printf ("\n" \
"                    <script src=\"%s\"></script>\n" \
"                    <script>\n" \
"                        var config = {\n" \
"                            startOnLoad: true,\n" \
"                            pie:{\n" \
"                                    useMaxWidth:false,\n" \
"                                    htmlLabels:true\n" \
"                            }\n" \
"                        };\n" \
"                        mermaid.initialize(config);\n" \
"                        mermaid.init(undefined, document.querySelector" \
"All('.language-mermaid'));\n" \
"                    </script>\n" \
"                ", _tmp3_);
#line 151 "../src/Widgets/WebView.vala"
		mermaid = _tmp4_;
#line 165 "../src/Widgets/WebView.vala"
		result = mermaid;
#line 165 "../src/Widgets/WebView.vala"
		_g_free0 (render);
#line 165 "../src/Widgets/WebView.vala"
		return result;
#line 954 "WebView.c"
	} else {
		gchar* _tmp5_;
#line 167 "../src/Widgets/WebView.vala"
		_tmp5_ = g_strdup ("");
#line 167 "../src/Widgets/WebView.vala"
		result = _tmp5_;
#line 167 "../src/Widgets/WebView.vala"
		return result;
#line 963 "WebView.c"
	}
}

static gboolean
__lambda4_ (QuilterWidgetsPreview* self,
            WebKitPolicyDecision* decision,
            WebKitPolicyDecisionType type)
{
	gboolean result = FALSE;
#line 172 "../src/Widgets/WebView.vala"
	g_return_val_if_fail (decision != NULL, FALSE);
#line 173 "../src/Widgets/WebView.vala"
	switch (type) {
#line 173 "../src/Widgets/WebView.vala"
		case WEBKIT_POLICY_DECISION_TYPE_NEW_WINDOW_ACTION:
#line 979 "WebView.c"
		{
#line 175 "../src/Widgets/WebView.vala"
			if (G_TYPE_CHECK_INSTANCE_TYPE (decision, webkit_response_policy_decision_get_type ())) {
#line 983 "WebView.c"
				WebKitResponsePolicyDecision* policy = NULL;
				WebKitResponsePolicyDecision* _tmp0_;
				WebKitResponsePolicyDecision* _tmp1_;
				WebKitURIRequest* _tmp2_;
				WebKitURIRequest* _tmp3_;
				const gchar* _tmp4_;
#line 176 "../src/Widgets/WebView.vala"
				_tmp0_ = _g_object_ref0 (G_TYPE_CHECK_INSTANCE_CAST (decision, webkit_response_policy_decision_get_type (), WebKitResponsePolicyDecision));
#line 176 "../src/Widgets/WebView.vala"
				policy = _tmp0_;
#line 177 "../src/Widgets/WebView.vala"
				_tmp1_ = policy;
#line 177 "../src/Widgets/WebView.vala"
				_tmp2_ = webkit_response_policy_decision_get_request (_tmp1_);
#line 177 "../src/Widgets/WebView.vala"
				_tmp3_ = _tmp2_;
#line 177 "../src/Widgets/WebView.vala"
				_tmp4_ = webkit_uri_request_get_uri (_tmp3_);
#line 177 "../src/Widgets/WebView.vala"
				quilter_widgets_preview_launch_browser (self, _tmp4_);
#line 175 "../src/Widgets/WebView.vala"
				_g_object_unref0 (policy);
#line 1006 "WebView.c"
			}
#line 179 "../src/Widgets/WebView.vala"
			break;
#line 1010 "WebView.c"
		}
#line 173 "../src/Widgets/WebView.vala"
		case WEBKIT_POLICY_DECISION_TYPE_RESPONSE:
#line 1014 "WebView.c"
		{
#line 181 "../src/Widgets/WebView.vala"
			if (G_TYPE_CHECK_INSTANCE_TYPE (decision, webkit_response_policy_decision_get_type ())) {
#line 1018 "WebView.c"
				WebKitResponsePolicyDecision* policy = NULL;
				WebKitResponsePolicyDecision* _tmp5_;
				WebKitResponsePolicyDecision* _tmp6_;
				WebKitURIRequest* _tmp7_;
				WebKitURIRequest* _tmp8_;
				const gchar* _tmp9_;
#line 182 "../src/Widgets/WebView.vala"
				_tmp5_ = _g_object_ref0 (G_TYPE_CHECK_INSTANCE_CAST (decision, webkit_response_policy_decision_get_type (), WebKitResponsePolicyDecision));
#line 182 "../src/Widgets/WebView.vala"
				policy = _tmp5_;
#line 183 "../src/Widgets/WebView.vala"
				_tmp6_ = policy;
#line 183 "../src/Widgets/WebView.vala"
				_tmp7_ = webkit_response_policy_decision_get_request (_tmp6_);
#line 183 "../src/Widgets/WebView.vala"
				_tmp8_ = _tmp7_;
#line 183 "../src/Widgets/WebView.vala"
				_tmp9_ = webkit_uri_request_get_uri (_tmp8_);
#line 183 "../src/Widgets/WebView.vala"
				quilter_widgets_preview_launch_browser (self, _tmp9_);
#line 184 "../src/Widgets/WebView.vala"
				result = FALSE;
#line 184 "../src/Widgets/WebView.vala"
				_g_object_unref0 (policy);
#line 184 "../src/Widgets/WebView.vala"
				return result;
#line 1045 "WebView.c"
			}
#line 186 "../src/Widgets/WebView.vala"
			break;
#line 1049 "WebView.c"
		}
#line 173 "../src/Widgets/WebView.vala"
		case WEBKIT_POLICY_DECISION_TYPE_NAVIGATION_ACTION:
#line 1053 "WebView.c"
		{
#line 188 "../src/Widgets/WebView.vala"
			break;
#line 1057 "WebView.c"
		}
		default:
#line 173 "../src/Widgets/WebView.vala"
		break;
#line 1062 "WebView.c"
	}
#line 191 "../src/Widgets/WebView.vala"
	result = TRUE;
#line 191 "../src/Widgets/WebView.vala"
	return result;
#line 1068 "WebView.c"
}

static gboolean
___lambda4__webkit_web_view_decide_policy (WebKitWebView* _sender,
                                           WebKitPolicyDecision* decision,
                                           WebKitPolicyDecisionType type,
                                           gpointer self)
{
	gboolean result;
	result = __lambda4_ ((QuilterWidgetsPreview*) self, decision, type);
#line 172 "../src/Widgets/WebView.vala"
	return result;
#line 1081 "WebView.c"
}

static void
__lambda5_ (QuilterWidgetsPreview* self,
            WebKitLoadEvent event)
{
#line 195 "../src/Widgets/WebView.vala"
	if (event == WEBKIT_LOAD_FINISHED) {
#line 1090 "WebView.c"
		GdkRectangle rectangle = {0};
		WebKitWindowProperties* _tmp0_;
		GdkRectangle _tmp1_ = {0};
		GdkRectangle _tmp2_;
		GdkRectangle _tmp3_;
#line 196 "../src/Widgets/WebView.vala"
		_tmp0_ = webkit_web_view_get_window_properties ((WebKitWebView*) self);
#line 196 "../src/Widgets/WebView.vala"
		webkit_window_properties_get_geometry (_tmp0_, &_tmp1_);
#line 196 "../src/Widgets/WebView.vala"
		rectangle = _tmp1_;
#line 197 "../src/Widgets/WebView.vala"
		_tmp2_ = rectangle;
#line 197 "../src/Widgets/WebView.vala"
		_tmp3_ = rectangle;
#line 197 "../src/Widgets/WebView.vala"
		gtk_widget_set_size_request ((GtkWidget*) self, _tmp2_.width, _tmp3_.height);
#line 1108 "WebView.c"
	}
}

static void
___lambda5__webkit_web_view_load_changed (WebKitWebView* _sender,
                                          WebKitLoadEvent load_event,
                                          gpointer self)
{
#line 194 "../src/Widgets/WebView.vala"
	__lambda5_ ((QuilterWidgetsPreview*) self, load_event);
#line 1119 "WebView.c"
}

static void
quilter_widgets_preview_connect_signals (QuilterWidgetsPreview* self)
{
#line 171 "../src/Widgets/WebView.vala"
	g_return_if_fail (self != NULL);
#line 172 "../src/Widgets/WebView.vala"
	g_signal_connect_object ((WebKitWebView*) self, "decide-policy", (GCallback) ___lambda4__webkit_web_view_decide_policy, self, 0);
#line 194 "../src/Widgets/WebView.vala"
	g_signal_connect_object ((WebKitWebView*) self, "load-changed", (GCallback) ___lambda5__webkit_web_view_load_changed, self, 0);
#line 1131 "WebView.c"
}

static gboolean
string_contains (const gchar* self,
                 const gchar* needle)
{
	gchar* _tmp0_;
	gboolean result = FALSE;
#line 1530 "glib-2.0.vapi"
	g_return_val_if_fail (self != NULL, FALSE);
#line 1530 "glib-2.0.vapi"
	g_return_val_if_fail (needle != NULL, FALSE);
#line 1531 "glib-2.0.vapi"
	_tmp0_ = strstr ((gchar*) self, (gchar*) needle);
#line 1531 "glib-2.0.vapi"
	result = _tmp0_ != NULL;
#line 1531 "glib-2.0.vapi"
	return result;
#line 1150 "WebView.c"
}

static void
quilter_widgets_preview_launch_browser (QuilterWidgetsPreview* self,
                                        const gchar* url)
{
	GError* _inner_error0_ = NULL;
#line 202 "../src/Widgets/WebView.vala"
	g_return_if_fail (self != NULL);
#line 202 "../src/Widgets/WebView.vala"
	g_return_if_fail (url != NULL);
#line 203 "../src/Widgets/WebView.vala"
	if (!string_contains (url, "/embed/")) {
#line 1164 "WebView.c"
		{
#line 205 "../src/Widgets/WebView.vala"
			g_app_info_launch_default_for_uri (url, NULL, &_inner_error0_);
#line 205 "../src/Widgets/WebView.vala"
			if (G_UNLIKELY (_inner_error0_ != NULL)) {
#line 1170 "WebView.c"
				goto __catch0_g_error;
			}
		}
		goto __finally0;
		__catch0_g_error:
		{
			GError* e = NULL;
			GError* _tmp0_;
			const gchar* _tmp1_;
#line 204 "../src/Widgets/WebView.vala"
			e = _inner_error0_;
#line 204 "../src/Widgets/WebView.vala"
			_inner_error0_ = NULL;
#line 207 "../src/Widgets/WebView.vala"
			_tmp0_ = e;
#line 207 "../src/Widgets/WebView.vala"
			_tmp1_ = _tmp0_->message;
#line 207 "../src/Widgets/WebView.vala"
			g_warning ("WebView.vala:207: No app to handle urls: %s", _tmp1_);
#line 204 "../src/Widgets/WebView.vala"
			_g_error_free0 (e);
#line 1192 "WebView.c"
		}
		__finally0:
#line 204 "../src/Widgets/WebView.vala"
		if (G_UNLIKELY (_inner_error0_ != NULL)) {
#line 204 "../src/Widgets/WebView.vala"
			g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _inner_error0_->message, g_quark_to_string (_inner_error0_->domain), _inner_error0_->code);
#line 204 "../src/Widgets/WebView.vala"
			g_clear_error (&_inner_error0_);
#line 204 "../src/Widgets/WebView.vala"
			return;
#line 1203 "WebView.c"
		}
#line 209 "../src/Widgets/WebView.vala"
		webkit_web_view_stop_loading ((WebKitWebView*) self);
#line 1207 "WebView.c"
	}
}

/**
         * Process the frontmatter of a markdown document, if it exists.
         * Returns the frontmatter data and strips the frontmatter from the markdown doc.
         *
         * @see http://jekyllrb.com/docs/frontmatter/
         */
static gchar*
string_slice (const gchar* self,
              glong start,
              glong end)
{
	glong string_length = 0L;
	gint _tmp0_;
	gint _tmp1_;
	gboolean _tmp2_ = FALSE;
	gboolean _tmp3_ = FALSE;
	gchar* _tmp4_;
	gchar* result = NULL;
#line 1480 "glib-2.0.vapi"
	g_return_val_if_fail (self != NULL, NULL);
#line 1481 "glib-2.0.vapi"
	_tmp0_ = strlen (self);
#line 1481 "glib-2.0.vapi"
	_tmp1_ = _tmp0_;
#line 1481 "glib-2.0.vapi"
	string_length = (glong) _tmp1_;
#line 1482 "glib-2.0.vapi"
	if (start < ((glong) 0)) {
#line 1483 "glib-2.0.vapi"
		start = string_length + start;
#line 1241 "WebView.c"
	}
#line 1485 "glib-2.0.vapi"
	if (end < ((glong) 0)) {
#line 1486 "glib-2.0.vapi"
		end = string_length + end;
#line 1247 "WebView.c"
	}
#line 1488 "glib-2.0.vapi"
	if (start >= ((glong) 0)) {
#line 1488 "glib-2.0.vapi"
		_tmp2_ = start <= string_length;
#line 1253 "WebView.c"
	} else {
#line 1488 "glib-2.0.vapi"
		_tmp2_ = FALSE;
#line 1257 "WebView.c"
	}
#line 1488 "glib-2.0.vapi"
	g_return_val_if_fail (_tmp2_, NULL);
#line 1489 "glib-2.0.vapi"
	if (end >= ((glong) 0)) {
#line 1489 "glib-2.0.vapi"
		_tmp3_ = end <= string_length;
#line 1265 "WebView.c"
	} else {
#line 1489 "glib-2.0.vapi"
		_tmp3_ = FALSE;
#line 1269 "WebView.c"
	}
#line 1489 "glib-2.0.vapi"
	g_return_val_if_fail (_tmp3_, NULL);
#line 1490 "glib-2.0.vapi"
	g_return_val_if_fail (start <= end, NULL);
#line 1491 "glib-2.0.vapi"
	_tmp4_ = g_strndup (((gchar*) self) + start, (gsize) (end - start));
#line 1491 "glib-2.0.vapi"
	result = _tmp4_;
#line 1491 "glib-2.0.vapi"
	return result;
#line 1281 "WebView.c"
}

static gint
string_index_of_char (const gchar* self,
                      gunichar c,
                      gint start_index)
{
	gchar* _result_ = NULL;
	gchar* _tmp0_;
	gchar* _tmp1_;
	gint result = 0;
#line 1153 "glib-2.0.vapi"
	g_return_val_if_fail (self != NULL, 0);
#line 1154 "glib-2.0.vapi"
	_tmp0_ = g_utf8_strchr (((gchar*) self) + start_index, (gssize) -1, c);
#line 1154 "glib-2.0.vapi"
	_result_ = _tmp0_;
#line 1156 "glib-2.0.vapi"
	_tmp1_ = _result_;
#line 1156 "glib-2.0.vapi"
	if (_tmp1_ != NULL) {
#line 1303 "WebView.c"
		gchar* _tmp2_;
#line 1157 "glib-2.0.vapi"
		_tmp2_ = _result_;
#line 1157 "glib-2.0.vapi"
		result = (gint) (_tmp2_ - ((gchar*) self));
#line 1157 "glib-2.0.vapi"
		return result;
#line 1311 "WebView.c"
	} else {
#line 1159 "glib-2.0.vapi"
		result = -1;
#line 1159 "glib-2.0.vapi"
		return result;
#line 1317 "WebView.c"
	}
}

static void
_vala_array_add5 (gchar** * array,
                  gint* length,
                  gint* size,
                  gchar* value)
{
#line 245 "../src/Widgets/WebView.vala"
	if ((*length) == (*size)) {
#line 245 "../src/Widgets/WebView.vala"
		*size = (*size) ? (2 * (*size)) : 4;
#line 245 "../src/Widgets/WebView.vala"
		*array = g_renew (gchar*, *array, (*size) + 1);
#line 1333 "WebView.c"
	}
#line 245 "../src/Widgets/WebView.vala"
	(*array)[(*length)++] = value;
#line 245 "../src/Widgets/WebView.vala"
	(*array)[*length] = NULL;
#line 1339 "WebView.c"
}

static void
_vala_array_add6 (gchar** * array,
                  gint* length,
                  gint* size,
                  gchar* value)
{
#line 246 "../src/Widgets/WebView.vala"
	if ((*length) == (*size)) {
#line 246 "../src/Widgets/WebView.vala"
		*size = (*size) ? (2 * (*size)) : 4;
#line 246 "../src/Widgets/WebView.vala"
		*array = g_renew (gchar*, *array, (*size) + 1);
#line 1354 "WebView.c"
	}
#line 246 "../src/Widgets/WebView.vala"
	(*array)[(*length)++] = value;
#line 246 "../src/Widgets/WebView.vala"
	(*array)[*length] = NULL;
#line 1360 "WebView.c"
}

static gchar**
quilter_widgets_preview_process_frontmatter (QuilterWidgetsPreview* self,
                                             const gchar* raw_mk,
                                             gchar* * processed_mk,
                                             gint* result_length1)
{
	gchar* _vala_processed_mk = NULL;
	gchar** map = NULL;
	gchar** _tmp0_;
	gint map_length1;
	gint _map_size_;
	gboolean _tmp1_ = FALSE;
	gint _tmp2_;
	gint _tmp3_;
	const gchar* _tmp21_;
	gchar** _tmp23_;
	gint _tmp23__length1;
	gchar** result = NULL;
#line 219 "../src/Widgets/WebView.vala"
	g_return_val_if_fail (self != NULL, NULL);
#line 219 "../src/Widgets/WebView.vala"
	g_return_val_if_fail (raw_mk != NULL, NULL);
#line 220 "../src/Widgets/WebView.vala"
	_tmp0_ = g_new0 (gchar*, 0 + 1);
#line 220 "../src/Widgets/WebView.vala"
	map = _tmp0_;
#line 220 "../src/Widgets/WebView.vala"
	map_length1 = 0;
#line 220 "../src/Widgets/WebView.vala"
	_map_size_ = map_length1;
#line 222 "../src/Widgets/WebView.vala"
	_g_free0 (_vala_processed_mk);
#line 222 "../src/Widgets/WebView.vala"
	_vala_processed_mk = NULL;
#line 224 "../src/Widgets/WebView.vala"
	_tmp2_ = strlen (raw_mk);
#line 224 "../src/Widgets/WebView.vala"
	_tmp3_ = _tmp2_;
#line 224 "../src/Widgets/WebView.vala"
	if (_tmp3_ > 4) {
#line 1403 "WebView.c"
		gchar* _tmp4_;
		gchar* _tmp5_;
#line 224 "../src/Widgets/WebView.vala"
		_tmp4_ = string_slice (raw_mk, (glong) 0, (glong) 4);
#line 224 "../src/Widgets/WebView.vala"
		_tmp5_ = _tmp4_;
#line 224 "../src/Widgets/WebView.vala"
		_tmp1_ = g_strcmp0 (_tmp5_, "---\n") == 0;
#line 224 "../src/Widgets/WebView.vala"
		_g_free0 (_tmp5_);
#line 1414 "WebView.c"
	} else {
#line 224 "../src/Widgets/WebView.vala"
		_tmp1_ = FALSE;
#line 1418 "WebView.c"
	}
#line 224 "../src/Widgets/WebView.vala"
	if (_tmp1_) {
#line 1422 "WebView.c"
		gint i = 0;
		gboolean valid_frontmatter = FALSE;
		gint last_newline = 0;
		gint next_newline = 0;
		gchar* line = NULL;
		gchar* _tmp6_;
#line 225 "../src/Widgets/WebView.vala"
		i = 0;
#line 226 "../src/Widgets/WebView.vala"
		valid_frontmatter = TRUE;
#line 227 "../src/Widgets/WebView.vala"
		last_newline = 3;
#line 229 "../src/Widgets/WebView.vala"
		_tmp6_ = g_strdup ("");
#line 229 "../src/Widgets/WebView.vala"
		line = _tmp6_;
#line 230 "../src/Widgets/WebView.vala"
		while (TRUE) {
#line 1441 "WebView.c"
			gchar* _tmp7_;
			const gchar* _tmp8_;
			gint sep_index = 0;
			const gchar* _tmp9_;
			gint _tmp17_;
#line 231 "../src/Widgets/WebView.vala"
			next_newline = string_index_of_char (raw_mk, (gunichar) '\n', last_newline + 1);
#line 232 "../src/Widgets/WebView.vala"
			if (next_newline == -1) {
#line 233 "../src/Widgets/WebView.vala"
				valid_frontmatter = FALSE;
#line 234 "../src/Widgets/WebView.vala"
				break;
#line 1455 "WebView.c"
			}
#line 236 "../src/Widgets/WebView.vala"
			_tmp7_ = string_slice (raw_mk, (glong) (last_newline + 1), (glong) next_newline);
#line 236 "../src/Widgets/WebView.vala"
			_g_free0 (line);
#line 236 "../src/Widgets/WebView.vala"
			line = _tmp7_;
#line 237 "../src/Widgets/WebView.vala"
			last_newline = next_newline;
#line 239 "../src/Widgets/WebView.vala"
			_tmp8_ = line;
#line 239 "../src/Widgets/WebView.vala"
			if (g_strcmp0 (_tmp8_, "---") == 0) {
#line 240 "../src/Widgets/WebView.vala"
				break;
#line 1471 "WebView.c"
			}
#line 243 "../src/Widgets/WebView.vala"
			_tmp9_ = line;
#line 243 "../src/Widgets/WebView.vala"
			sep_index = string_index_of_char (_tmp9_, (gunichar) ':', 0);
#line 244 "../src/Widgets/WebView.vala"
			if (sep_index != -1) {
#line 1479 "WebView.c"
				const gchar* _tmp10_;
				gchar* _tmp11_;
				const gchar* _tmp12_;
				const gchar* _tmp13_;
				gint _tmp14_;
				gint _tmp15_;
				gchar* _tmp16_;
#line 245 "../src/Widgets/WebView.vala"
				_tmp10_ = line;
#line 245 "../src/Widgets/WebView.vala"
				_tmp11_ = string_slice (_tmp10_, (glong) 0, (glong) (sep_index - 1));
#line 245 "../src/Widgets/WebView.vala"
				_vala_array_add5 (&map, &map_length1, &_map_size_, _tmp11_);
#line 246 "../src/Widgets/WebView.vala"
				_tmp12_ = line;
#line 246 "../src/Widgets/WebView.vala"
				_tmp13_ = line;
#line 246 "../src/Widgets/WebView.vala"
				_tmp14_ = strlen (_tmp13_);
#line 246 "../src/Widgets/WebView.vala"
				_tmp15_ = _tmp14_;
#line 246 "../src/Widgets/WebView.vala"
				_tmp16_ = string_slice (_tmp12_, (glong) (sep_index + 1), (glong) _tmp15_);
#line 246 "../src/Widgets/WebView.vala"
				_vala_array_add6 (&map, &map_length1, &_map_size_, _tmp16_);
#line 1505 "WebView.c"
			} else {
#line 248 "../src/Widgets/WebView.vala"
				valid_frontmatter = FALSE;
#line 249 "../src/Widgets/WebView.vala"
				break;
#line 1511 "WebView.c"
			}
#line 252 "../src/Widgets/WebView.vala"
			_tmp17_ = i;
#line 252 "../src/Widgets/WebView.vala"
			i = _tmp17_ + 1;
#line 1517 "WebView.c"
		}
#line 255 "../src/Widgets/WebView.vala"
		if (valid_frontmatter) {
#line 1521 "WebView.c"
			gint _tmp18_;
			gint _tmp19_;
			gchar* _tmp20_;
#line 256 "../src/Widgets/WebView.vala"
			_tmp18_ = strlen (raw_mk);
#line 256 "../src/Widgets/WebView.vala"
			_tmp19_ = _tmp18_;
#line 256 "../src/Widgets/WebView.vala"
			_tmp20_ = string_slice (raw_mk, (glong) last_newline, (glong) _tmp19_);
#line 256 "../src/Widgets/WebView.vala"
			_g_free0 (_vala_processed_mk);
#line 256 "../src/Widgets/WebView.vala"
			_vala_processed_mk = _tmp20_;
#line 1535 "WebView.c"
		}
#line 224 "../src/Widgets/WebView.vala"
		_g_free0 (line);
#line 1539 "WebView.c"
	}
#line 260 "../src/Widgets/WebView.vala"
	_tmp21_ = _vala_processed_mk;
#line 260 "../src/Widgets/WebView.vala"
	if (_tmp21_ == NULL) {
#line 1545 "WebView.c"
		gchar* _tmp22_;
#line 261 "../src/Widgets/WebView.vala"
		_tmp22_ = g_strdup (raw_mk);
#line 261 "../src/Widgets/WebView.vala"
		_g_free0 (_vala_processed_mk);
#line 261 "../src/Widgets/WebView.vala"
		_vala_processed_mk = _tmp22_;
#line 1553 "WebView.c"
	}
#line 264 "../src/Widgets/WebView.vala"
	_tmp23_ = map;
#line 264 "../src/Widgets/WebView.vala"
	_tmp23__length1 = map_length1;
#line 264 "../src/Widgets/WebView.vala"
	if (result_length1) {
#line 264 "../src/Widgets/WebView.vala"
		*result_length1 = _tmp23__length1;
#line 1563 "WebView.c"
	}
#line 264 "../src/Widgets/WebView.vala"
	result = _tmp23_;
#line 264 "../src/Widgets/WebView.vala"
	if (processed_mk) {
#line 264 "../src/Widgets/WebView.vala"
		*processed_mk = _vala_processed_mk;
#line 1571 "WebView.c"
	} else {
#line 264 "../src/Widgets/WebView.vala"
		_g_free0 (_vala_processed_mk);
#line 1575 "WebView.c"
	}
#line 264 "../src/Widgets/WebView.vala"
	return result;
#line 1579 "WebView.c"
}

static guint8*
string_get_data (const gchar* self,
                 gint* result_length1)
{
	guint8* result;
	guint8* res = NULL;
	gint res_length1;
	gint _res_size_;
	gint _tmp0_;
	gint _tmp1_;
	guint8* _tmp2_;
	gint _tmp2__length1;
#line 1555 "glib-2.0.vapi"
	g_return_val_if_fail (self != NULL, NULL);
#line 1556 "glib-2.0.vapi"
	res = (guint8*) self;
#line 1556 "glib-2.0.vapi"
	res_length1 = -1;
#line 1556 "glib-2.0.vapi"
	_res_size_ = res_length1;
#line 1557 "glib-2.0.vapi"
	_tmp0_ = strlen (self);
#line 1557 "glib-2.0.vapi"
	_tmp1_ = _tmp0_;
#line 1557 "glib-2.0.vapi"
	res_length1 = (gint) _tmp1_;
#line 1558 "glib-2.0.vapi"
	_tmp2_ = res;
#line 1558 "glib-2.0.vapi"
	_tmp2__length1 = res_length1;
#line 1558 "glib-2.0.vapi"
	if (result_length1) {
#line 1558 "glib-2.0.vapi"
		*result_length1 = _tmp2__length1;
#line 1616 "WebView.c"
	}
#line 1558 "glib-2.0.vapi"
	result = _tmp2_;
#line 1558 "glib-2.0.vapi"
	return result;
#line 1622 "WebView.c"
}

void
quilter_widgets_preview_update_html_view (QuilterWidgetsPreview* self)
{
	gchar* processed_mk = NULL;
	QuilterWidgetsEditView* _tmp0_;
	gchar* _tmp1_;
	gchar* _tmp2_;
	gchar* _tmp3_;
	gchar* _tmp4_ = NULL;
	gint _tmp5_ = 0;
	gchar** _tmp6_;
	gchar** _tmp7_;
	gint _tmp7__length1;
	MMIOT* mkd = NULL;
	const gchar* _tmp8_;
	guint8* _tmp9_;
	gint _tmp9__length1;
	gint _tmp10_ = 0;
	guint8* _tmp11_;
	gint _tmp11__length1;
	MMIOT* _tmp12_;
	MMIOT* _tmp13_;
	MMIOT* _tmp14_;
	const gchar* _tmp15_ = NULL;
	gchar* _tmp16_;
	gchar* highlight = NULL;
	gchar* _tmp17_;
	gchar* cheaders = NULL;
	gchar* _tmp18_;
	gchar* latex = NULL;
	gchar* _tmp19_;
	gchar* mermaid = NULL;
	gchar* _tmp20_;
	gchar* font = NULL;
	gchar* _tmp21_;
	gchar* style = NULL;
	gchar* _tmp22_;
	gchar* md = NULL;
	const gchar* _tmp23_;
	gchar* _tmp24_;
	gboolean focus_active = FALSE;
	GSettings* _tmp25_;
	gboolean typewriter_active = FALSE;
	GSettings* _tmp26_;
	gboolean _tmp27_ = FALSE;
	const gchar* _tmp32_;
	const gchar* _tmp33_;
	const gchar* _tmp34_;
	const gchar* _tmp35_;
	const gchar* _tmp36_;
	const gchar* _tmp37_;
	const gchar* _tmp38_;
	gchar* _tmp39_;
	const gchar* _tmp40_;
#line 267 "../src/Widgets/WebView.vala"
	g_return_if_fail (self != NULL);
#line 269 "../src/Widgets/WebView.vala"
	_tmp0_ = self->buf;
#line 269 "../src/Widgets/WebView.vala"
	_tmp1_ = quilter_widgets_edit_view_get_text (_tmp0_);
#line 269 "../src/Widgets/WebView.vala"
	_tmp2_ = _tmp1_;
#line 269 "../src/Widgets/WebView.vala"
	_tmp3_ = _tmp2_;
#line 269 "../src/Widgets/WebView.vala"
	_tmp6_ = quilter_widgets_preview_process_frontmatter (self, _tmp3_, &_tmp4_, &_tmp5_);
#line 269 "../src/Widgets/WebView.vala"
	_g_free0 (processed_mk);
#line 269 "../src/Widgets/WebView.vala"
	processed_mk = _tmp4_;
#line 269 "../src/Widgets/WebView.vala"
	_tmp7_ = _tmp6_;
#line 269 "../src/Widgets/WebView.vala"
	_tmp7__length1 = _tmp5_;
#line 269 "../src/Widgets/WebView.vala"
	_tmp7_ = (_vala_array_free (_tmp7_, _tmp7__length1, (GDestroyNotify) g_free), NULL);
#line 269 "../src/Widgets/WebView.vala"
	_g_free0 (_tmp3_);
#line 270 "../src/Widgets/WebView.vala"
	_tmp8_ = processed_mk;
#line 270 "../src/Widgets/WebView.vala"
	_tmp9_ = string_get_data (_tmp8_, &_tmp10_);
#line 270 "../src/Widgets/WebView.vala"
	_tmp9__length1 = _tmp10_;
#line 270 "../src/Widgets/WebView.vala"
	_tmp11_ = _tmp9_;
#line 270 "../src/Widgets/WebView.vala"
	_tmp11__length1 = _tmp9__length1;
#line 270 "../src/Widgets/WebView.vala"
	_tmp12_ = gfm_string (_tmp11_, _tmp11__length1, (((((((((MKD_TOC + MKD_AUTOLINK) + MKD_EXTRA_FOOTNOTE) + MKD_AUTOLINK) + MKD_DLEXTRA) + MKD_FENCEDCODE) + MKD_GITHUBTAGS) + MKD_LATEX) + MKD_URLENCODEDANCHOR) + MKD_NOSTYLE) + MKD_EXPLICITLIST);
#line 270 "../src/Widgets/WebView.vala"
	mkd = _tmp12_;
#line 278 "../src/Widgets/WebView.vala"
	_tmp13_ = mkd;
#line 278 "../src/Widgets/WebView.vala"
	mkd_compile (_tmp13_, (((((((((MKD_TOC + MKD_AUTOLINK) + MKD_EXTRA_FOOTNOTE) + MKD_AUTOLINK) + MKD_DLEXTRA) + MKD_FENCEDCODE) + MKD_GITHUBTAGS) + MKD_LATEX) + MKD_URLENCODEDANCHOR) + MKD_EXPLICITLIST) + MKD_NOSTYLE);
#line 286 "../src/Widgets/WebView.vala"
	_tmp14_ = mkd;
#line 286 "../src/Widgets/WebView.vala"
	mkd_document (_tmp14_, &_tmp15_);
#line 286 "../src/Widgets/WebView.vala"
	_g_free0 (processed_mk);
#line 286 "../src/Widgets/WebView.vala"
	_tmp16_ = g_strdup (_tmp15_);
#line 286 "../src/Widgets/WebView.vala"
	processed_mk = _tmp16_;
#line 287 "../src/Widgets/WebView.vala"
	_tmp17_ = quilter_widgets_preview_set_highlight (self);
#line 287 "../src/Widgets/WebView.vala"
	highlight = _tmp17_;
#line 288 "../src/Widgets/WebView.vala"
	_tmp18_ = quilter_widgets_preview_set_center_headers (self);
#line 288 "../src/Widgets/WebView.vala"
	cheaders = _tmp18_;
#line 289 "../src/Widgets/WebView.vala"
	_tmp19_ = quilter_widgets_preview_set_latex (self);
#line 289 "../src/Widgets/WebView.vala"
	latex = _tmp19_;
#line 290 "../src/Widgets/WebView.vala"
	_tmp20_ = quilter_widgets_preview_set_mermaid (self);
#line 290 "../src/Widgets/WebView.vala"
	mermaid = _tmp20_;
#line 291 "../src/Widgets/WebView.vala"
	_tmp21_ = quilter_widgets_preview_set_font_stylesheet (self);
#line 291 "../src/Widgets/WebView.vala"
	font = _tmp21_;
#line 292 "../src/Widgets/WebView.vala"
	_tmp22_ = quilter_widgets_preview_set_stylesheet (self);
#line 292 "../src/Widgets/WebView.vala"
	style = _tmp22_;
#line 293 "../src/Widgets/WebView.vala"
	_tmp23_ = processed_mk;
#line 293 "../src/Widgets/WebView.vala"
	_tmp24_ = quilter_widgets_preview_process_plugins (self, _tmp23_);
#line 293 "../src/Widgets/WebView.vala"
	md = _tmp24_;
#line 295 "../src/Widgets/WebView.vala"
	_tmp25_ = quilter_application_gsettings;
#line 295 "../src/Widgets/WebView.vala"
	focus_active = g_settings_get_boolean (_tmp25_, "focus-mode");
#line 296 "../src/Widgets/WebView.vala"
	_tmp26_ = quilter_application_gsettings;
#line 296 "../src/Widgets/WebView.vala"
	typewriter_active = g_settings_get_boolean (_tmp26_, "typewriter-scrolling");
#line 297 "../src/Widgets/WebView.vala"
	if (focus_active) {
#line 297 "../src/Widgets/WebView.vala"
		_tmp27_ = typewriter_active;
#line 1773 "WebView.c"
	} else {
#line 297 "../src/Widgets/WebView.vala"
		_tmp27_ = FALSE;
#line 1777 "WebView.c"
	}
#line 297 "../src/Widgets/WebView.vala"
	if (_tmp27_) {
#line 1781 "WebView.c"
		const gchar* _tmp28_;
		gchar* _tmp29_;
#line 298 "../src/Widgets/WebView.vala"
		_tmp28_ = style;
#line 298 "../src/Widgets/WebView.vala"
		_tmp29_ = g_strconcat (_tmp28_, "\n" \
"                html {\n" \
"                    padding-top: 50%;\n" \
"                    padding-bottom: 50%;\n" \
"                }\n" \
"                ", NULL);
#line 298 "../src/Widgets/WebView.vala"
		_g_free0 (style);
#line 298 "../src/Widgets/WebView.vala"
		style = _tmp29_;
#line 1792 "WebView.c"
	} else {
		const gchar* _tmp30_;
		gchar* _tmp31_;
#line 305 "../src/Widgets/WebView.vala"
		_tmp30_ = style;
#line 305 "../src/Widgets/WebView.vala"
		_tmp31_ = g_strconcat (_tmp30_, "\n" \
"                html {\n" \
"                    padding-bottom: 10%;\n" \
"                }\n" \
"                ", NULL);
#line 305 "../src/Widgets/WebView.vala"
		_g_free0 (style);
#line 305 "../src/Widgets/WebView.vala"
		style = _tmp31_;
#line 1804 "WebView.c"
	}
#line 312 "../src/Widgets/WebView.vala"
	_tmp32_ = style;
#line 312 "../src/Widgets/WebView.vala"
	_tmp33_ = highlight;
#line 312 "../src/Widgets/WebView.vala"
	_tmp34_ = latex;
#line 312 "../src/Widgets/WebView.vala"
	_tmp35_ = font;
#line 312 "../src/Widgets/WebView.vala"
	_tmp36_ = cheaders;
#line 312 "../src/Widgets/WebView.vala"
	_tmp37_ = mermaid;
#line 312 "../src/Widgets/WebView.vala"
	_tmp38_ = md;
#line 312 "../src/Widgets/WebView.vala"
	_tmp39_ = g_strdup_printf ("\n" \
"            <!doctype html>\n" \
"            <html>\n" \
"                <head>\n" \
"                    <meta charset=\"utf-8\">\n" \
"                    <style>%s</style>\n" \
"                    %s\n" \
"                    %s\n" \
"                    <link rel=\"stylesheet\" href=\"%s\"/>\n" \
"                    <link rel=\"stylesheet\" href=\"%s\"/>\n" \
"                </head>\n" \
"                <body>\n" \
"                    %s\n" \
"                    <div class=\"markdown-body\">\n" \
"                        %s\n" \
"                    </div>\n" \
"                </body>\n" \
"            </html>", _tmp32_, _tmp33_, _tmp34_, _tmp35_, _tmp36_, _tmp37_, _tmp38_);
#line 312 "../src/Widgets/WebView.vala"
	_g_free0 (self->html);
#line 312 "../src/Widgets/WebView.vala"
	self->html = _tmp39_;
#line 331 "../src/Widgets/WebView.vala"
	_tmp40_ = self->html;
#line 331 "../src/Widgets/WebView.vala"
	webkit_web_view_load_html ((WebKitWebView*) self, _tmp40_, "file:///");
#line 267 "../src/Widgets/WebView.vala"
	_g_free0 (md);
#line 267 "../src/Widgets/WebView.vala"
	_g_free0 (style);
#line 267 "../src/Widgets/WebView.vala"
	_g_free0 (font);
#line 267 "../src/Widgets/WebView.vala"
	_g_free0 (mermaid);
#line 267 "../src/Widgets/WebView.vala"
	_g_free0 (latex);
#line 267 "../src/Widgets/WebView.vala"
	_g_free0 (cheaders);
#line 267 "../src/Widgets/WebView.vala"
	_g_free0 (highlight);
#line 267 "../src/Widgets/WebView.vala"
	_mkd_cleanup0 (mkd);
#line 267 "../src/Widgets/WebView.vala"
	_g_free0 (processed_mk);
#line 1848 "WebView.c"
}

static void
_g_object_unref0_ (gpointer var)
{
#line 339 "../src/Widgets/WebView.vala"
	(var == NULL) ? NULL : (var = (g_object_unref (var), NULL));
#line 1856 "WebView.c"
}

static inline void
_g_list_free__g_object_unref0_ (GList* self)
{
#line 339 "../src/Widgets/WebView.vala"
	g_list_free_full (self, (GDestroyNotify) _g_object_unref0_);
#line 1864 "WebView.c"
}

static gchar*
quilter_widgets_preview_process_plugins (QuilterWidgetsPreview* self,
                                         const gchar* raw_mk)
{
	gchar** lines = NULL;
	gchar** _tmp0_;
	gchar** _tmp1_;
	gint lines_length1;
	gint _lines_size_;
	gchar* build = NULL;
	gchar* _tmp2_;
	gchar** _tmp3_;
	gint _tmp3__length1;
	gchar* result = NULL;
#line 334 "../src/Widgets/WebView.vala"
	g_return_val_if_fail (self != NULL, NULL);
#line 334 "../src/Widgets/WebView.vala"
	g_return_val_if_fail (raw_mk != NULL, NULL);
#line 335 "../src/Widgets/WebView.vala"
	_tmp1_ = _tmp0_ = g_strsplit (raw_mk, "\n", 0);
#line 335 "../src/Widgets/WebView.vala"
	lines = _tmp1_;
#line 335 "../src/Widgets/WebView.vala"
	lines_length1 = _vala_array_length (_tmp0_);
#line 335 "../src/Widgets/WebView.vala"
	_lines_size_ = lines_length1;
#line 336 "../src/Widgets/WebView.vala"
	_tmp2_ = g_strdup ("");
#line 336 "../src/Widgets/WebView.vala"
	build = _tmp2_;
#line 337 "../src/Widgets/WebView.vala"
	_tmp3_ = lines;
#line 337 "../src/Widgets/WebView.vala"
	_tmp3__length1 = lines_length1;
#line 1901 "WebView.c"
	{
		gchar** line_collection = NULL;
		gint line_collection_length1 = 0;
		gint _line_collection_size_ = 0;
		gint line_it = 0;
#line 337 "../src/Widgets/WebView.vala"
		line_collection = _tmp3_;
#line 337 "../src/Widgets/WebView.vala"
		line_collection_length1 = _tmp3__length1;
#line 337 "../src/Widgets/WebView.vala"
		for (line_it = 0; line_it < line_collection_length1; line_it = line_it + 1) {
#line 1913 "WebView.c"
			gchar* _tmp4_;
			gchar* line = NULL;
#line 337 "../src/Widgets/WebView.vala"
			_tmp4_ = g_strdup (line_collection[line_it]);
#line 337 "../src/Widgets/WebView.vala"
			line = _tmp4_;
#line 1920 "WebView.c"
			{
				gboolean found = FALSE;
				QuilterPluginsPluginManager* _tmp5_;
				QuilterPluginsPluginManager* _tmp6_;
				GList* _tmp7_;
				GList* _tmp8_;
#line 338 "../src/Widgets/WebView.vala"
				found = FALSE;
#line 339 "../src/Widgets/WebView.vala"
				_tmp5_ = quilter_plugins_plugin_manager_get_instance ();
#line 339 "../src/Widgets/WebView.vala"
				_tmp6_ = _tmp5_;
#line 339 "../src/Widgets/WebView.vala"
				_tmp7_ = quilter_plugins_plugin_manager_get_plugs (_tmp6_);
#line 339 "../src/Widgets/WebView.vala"
				_tmp8_ = _tmp7_;
#line 339 "../src/Widgets/WebView.vala"
				_g_object_unref0 (_tmp6_);
#line 1939 "WebView.c"
				{
					GList* plugin_collection = NULL;
					GList* plugin_it = NULL;
#line 339 "../src/Widgets/WebView.vala"
					plugin_collection = _tmp8_;
#line 339 "../src/Widgets/WebView.vala"
					for (plugin_it = plugin_collection; plugin_it != NULL; plugin_it = plugin_it->next) {
#line 1947 "WebView.c"
						QuilterPluginsPlugin* _tmp9_;
						QuilterPluginsPlugin* plugin = NULL;
#line 339 "../src/Widgets/WebView.vala"
						_tmp9_ = _g_object_ref0 ((QuilterPluginsPlugin*) plugin_it->data);
#line 339 "../src/Widgets/WebView.vala"
						plugin = _tmp9_;
#line 1954 "WebView.c"
						{
							QuilterPluginsPlugin* _tmp10_;
							const gchar* _tmp11_;
#line 340 "../src/Widgets/WebView.vala"
							_tmp10_ = plugin;
#line 340 "../src/Widgets/WebView.vala"
							_tmp11_ = line;
#line 340 "../src/Widgets/WebView.vala"
							if (quilter_plugins_plugin_has_match (_tmp10_, _tmp11_)) {
#line 1964 "WebView.c"
								const gchar* _tmp12_;
								QuilterPluginsPlugin* _tmp13_;
								const gchar* _tmp14_;
								gchar* _tmp15_;
								gchar* _tmp16_;
								gchar* _tmp17_;
								gchar* _tmp18_;
								gchar* _tmp19_;
#line 341 "../src/Widgets/WebView.vala"
								_tmp12_ = build;
#line 341 "../src/Widgets/WebView.vala"
								_tmp13_ = plugin;
#line 341 "../src/Widgets/WebView.vala"
								_tmp14_ = line;
#line 341 "../src/Widgets/WebView.vala"
								_tmp15_ = quilter_plugins_plugin_convert (_tmp13_, _tmp14_);
#line 341 "../src/Widgets/WebView.vala"
								_tmp16_ = _tmp15_;
#line 341 "../src/Widgets/WebView.vala"
								_tmp17_ = g_strconcat (_tmp12_, _tmp16_, NULL);
#line 341 "../src/Widgets/WebView.vala"
								_tmp18_ = _tmp17_;
#line 341 "../src/Widgets/WebView.vala"
								_tmp19_ = g_strconcat (_tmp18_, "\n", NULL);
#line 341 "../src/Widgets/WebView.vala"
								_g_free0 (build);
#line 341 "../src/Widgets/WebView.vala"
								build = _tmp19_;
#line 341 "../src/Widgets/WebView.vala"
								_g_free0 (_tmp18_);
#line 341 "../src/Widgets/WebView.vala"
								_g_free0 (_tmp16_);
#line 342 "../src/Widgets/WebView.vala"
								found = TRUE;
#line 343 "../src/Widgets/WebView.vala"
								_g_object_unref0 (plugin);
#line 343 "../src/Widgets/WebView.vala"
								break;
#line 2003 "WebView.c"
							}
#line 339 "../src/Widgets/WebView.vala"
							_g_object_unref0 (plugin);
#line 2007 "WebView.c"
						}
					}
#line 339 "../src/Widgets/WebView.vala"
					(plugin_collection == NULL) ? NULL : (plugin_collection = (_g_list_free__g_object_unref0_ (plugin_collection), NULL));
#line 2012 "WebView.c"
				}
#line 347 "../src/Widgets/WebView.vala"
				if (!found) {
#line 2016 "WebView.c"
					const gchar* _tmp20_;
					const gchar* _tmp21_;
					gchar* _tmp22_;
					gchar* _tmp23_;
					gchar* _tmp24_;
#line 348 "../src/Widgets/WebView.vala"
					_tmp20_ = build;
#line 348 "../src/Widgets/WebView.vala"
					_tmp21_ = line;
#line 348 "../src/Widgets/WebView.vala"
					_tmp22_ = g_strconcat (_tmp20_, _tmp21_, NULL);
#line 348 "../src/Widgets/WebView.vala"
					_tmp23_ = _tmp22_;
#line 348 "../src/Widgets/WebView.vala"
					_tmp24_ = g_strconcat (_tmp23_, "\n", NULL);
#line 348 "../src/Widgets/WebView.vala"
					_g_free0 (build);
#line 348 "../src/Widgets/WebView.vala"
					build = _tmp24_;
#line 348 "../src/Widgets/WebView.vala"
					_g_free0 (_tmp23_);
#line 2038 "WebView.c"
				}
#line 337 "../src/Widgets/WebView.vala"
				_g_free0 (line);
#line 2042 "WebView.c"
			}
		}
	}
#line 352 "../src/Widgets/WebView.vala"
	result = build;
#line 352 "../src/Widgets/WebView.vala"
	lines = (_vala_array_free (lines, lines_length1, (GDestroyNotify) g_free), NULL);
#line 352 "../src/Widgets/WebView.vala"
	return result;
#line 2052 "WebView.c"
}

void
quilter_widgets_preview_set_scroll_value (QuilterWidgetsPreview* self,
                                          gdouble value)
{
	gchar* _tmp0_;
	gchar* _tmp1_;
#line 26 "../src/Widgets/WebView.vala"
	g_return_if_fail (self != NULL);
#line 27 "../src/Widgets/WebView.vala"
	_tmp0_ = g_strdup_printf ("\n" \
"                    var b = document.body,\n" \
"                    e = document.documentElement;\n" \
"                    var height = Math.max( b.scrollHeight,\n" \
"                                           b.offsetHeight,\n" \
"                                           e.clientHeight,\n" \
"                                           e.scrollHeight,\n" \
"                                           e.offsetHeight\n" \
"                                 );\n" \
"                    e.scrollTop = (%.13f * e.offsetHeight);\n" \
"                    e.scrollTop;\n" \
"                ", value);
#line 27 "../src/Widgets/WebView.vala"
	_tmp1_ = _tmp0_;
#line 27 "../src/Widgets/WebView.vala"
	webkit_web_view_run_javascript ((WebKitWebView*) self, _tmp1_, NULL, NULL, NULL);
#line 27 "../src/Widgets/WebView.vala"
	_g_free0 (_tmp1_);
#line 26 "../src/Widgets/WebView.vala"
	g_object_notify_by_pspec ((GObject *) self, quilter_widgets_preview_properties[QUILTER_WIDGETS_PREVIEW_SCROLL_VALUE_PROPERTY]);
#line 2073 "WebView.c"
}

static void
quilter_widgets_preview_class_init (QuilterWidgetsPreviewClass * klass,
                                    gpointer klass_data)
{
#line 21 "../src/Widgets/WebView.vala"
	quilter_widgets_preview_parent_class = g_type_class_peek_parent (klass);
#line 21 "../src/Widgets/WebView.vala"
	((WebKitWebViewClass *) klass)->context_menu = (gboolean (*) (WebKitWebView*, WebKitContextMenu*, GdkEvent*, WebKitHitTestResult*)) quilter_widgets_preview_real_context_menu;
#line 21 "../src/Widgets/WebView.vala"
	G_OBJECT_CLASS (klass)->set_property = _vala_quilter_widgets_preview_set_property;
#line 21 "../src/Widgets/WebView.vala"
	G_OBJECT_CLASS (klass)->finalize = quilter_widgets_preview_finalize;
#line 21 "../src/Widgets/WebView.vala"
	g_object_class_install_property (G_OBJECT_CLASS (klass), QUILTER_WIDGETS_PREVIEW_SCROLL_VALUE_PROPERTY, quilter_widgets_preview_properties[QUILTER_WIDGETS_PREVIEW_SCROLL_VALUE_PROPERTY] = g_param_spec_double ("scroll-value", "scroll-value", "scroll-value", -G_MAXDOUBLE, G_MAXDOUBLE, 0.0, G_PARAM_STATIC_STRINGS | G_PARAM_WRITABLE));
#line 2090 "WebView.c"
}

static void
quilter_widgets_preview_instance_init (QuilterWidgetsPreview * self,
                                       gpointer klass)
{
}

static void
quilter_widgets_preview_finalize (GObject * obj)
{
	QuilterWidgetsPreview * self;
#line 21 "../src/Widgets/WebView.vala"
	self = G_TYPE_CHECK_INSTANCE_CAST (obj, QUILTER_WIDGETS_TYPE_PREVIEW, QuilterWidgetsPreview);
#line 23 "../src/Widgets/WebView.vala"
	_g_object_unref0 (self->buf);
#line 24 "../src/Widgets/WebView.vala"
	_g_free0 (self->html);
#line 21 "../src/Widgets/WebView.vala"
	G_OBJECT_CLASS (quilter_widgets_preview_parent_class)->finalize (obj);
#line 2111 "WebView.c"
}

static GType
quilter_widgets_preview_get_type_once (void)
{
	static const GTypeInfo g_define_type_info = { sizeof (QuilterWidgetsPreviewClass), (GBaseInitFunc) NULL, (GBaseFinalizeFunc) NULL, (GClassInitFunc) quilter_widgets_preview_class_init, (GClassFinalizeFunc) NULL, NULL, sizeof (QuilterWidgetsPreview), 0, (GInstanceInitFunc) quilter_widgets_preview_instance_init, NULL };
	GType quilter_widgets_preview_type_id;
	quilter_widgets_preview_type_id = g_type_register_static (webkit_web_view_get_type (), "QuilterWidgetsPreview", &g_define_type_info, 0);
	return quilter_widgets_preview_type_id;
}

GType
quilter_widgets_preview_get_type (void)
{
	static volatile gsize quilter_widgets_preview_type_id__volatile = 0;
	if (g_once_init_enter (&quilter_widgets_preview_type_id__volatile)) {
		GType quilter_widgets_preview_type_id;
		quilter_widgets_preview_type_id = quilter_widgets_preview_get_type_once ();
		g_once_init_leave (&quilter_widgets_preview_type_id__volatile, quilter_widgets_preview_type_id);
	}
	return quilter_widgets_preview_type_id__volatile;
}

static void
_vala_quilter_widgets_preview_set_property (GObject * object,
                                            guint property_id,
                                            const GValue * value,
                                            GParamSpec * pspec)
{
	QuilterWidgetsPreview * self;
	self = G_TYPE_CHECK_INSTANCE_CAST (object, QUILTER_WIDGETS_TYPE_PREVIEW, QuilterWidgetsPreview);
#line 21 "../src/Widgets/WebView.vala"
	switch (property_id) {
#line 21 "../src/Widgets/WebView.vala"
		case QUILTER_WIDGETS_PREVIEW_SCROLL_VALUE_PROPERTY:
#line 21 "../src/Widgets/WebView.vala"
		quilter_widgets_preview_set_scroll_value (self, g_value_get_double (value));
#line 21 "../src/Widgets/WebView.vala"
		break;
#line 2151 "WebView.c"
		default:
#line 21 "../src/Widgets/WebView.vala"
		G_OBJECT_WARN_INVALID_PROPERTY_ID (object, property_id, pspec);
#line 21 "../src/Widgets/WebView.vala"
		break;
#line 2157 "WebView.c"
	}
}

static void
_vala_array_destroy (gpointer array,
                     gint array_length,
                     GDestroyNotify destroy_func)
{
	if ((array != NULL) && (destroy_func != NULL)) {
		gint i;
		for (i = 0; i < array_length; i = i + 1) {
			if (((gpointer*) array)[i] != NULL) {
				destroy_func (((gpointer*) array)[i]);
			}
		}
	}
}

static void
_vala_array_free (gpointer array,
                  gint array_length,
                  GDestroyNotify destroy_func)
{
	_vala_array_destroy (array, array_length, destroy_func);
	g_free (array);
}

static gint
_vala_array_length (gpointer array)
{
	gint length;
	length = 0;
	if (array) {
		while (((gpointer*) array)[length]) {
			length++;
		}
	}
	return length;
}

